<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>Cubical.Algebra.IntegerMatrix.Diagonalization</title><link rel="stylesheet" href="Agda.css"></head><body><pre class="Agda"><a id="1" class="Comment">{-

This file contains a diagonalization procedure simpler than Smith normalization.
For any matrix M, it provides two invertible matrices P, Q, one diagonal matrix D and an equality M = P·D·Q.
The only difference from Smith is, the numbers in D are allowed to be arbitrary, instead of being consecutively divisible.
But it is enough to establish important properties of finitely presented abelian groups.
Also, it can be computed much more efficiently (than Smith, only).

-}</a>
<a id="478" class="Symbol">{-#</a> <a id="482" class="Keyword">OPTIONS</a> <a id="490" class="Pragma">--safe</a> <a id="497" class="Symbol">#-}</a>
<a id="501" class="Keyword">module</a> <a id="508" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html" class="Module">Cubical.Algebra.IntegerMatrix.Diagonalization</a> <a id="554" class="Keyword">where</a>

<a id="561" class="Keyword">open</a> <a id="566" class="Keyword">import</a> <a id="573" href="Cubical.Foundations.Prelude.html" class="Module">Cubical.Foundations.Prelude</a>
<a id="601" class="Keyword">open</a> <a id="606" class="Keyword">import</a> <a id="613" href="Cubical.Foundations.Function.html" class="Module">Cubical.Foundations.Function</a>
<a id="642" class="Keyword">open</a> <a id="647" class="Keyword">import</a> <a id="654" href="Cubical.Foundations.HLevels.html" class="Module">Cubical.Foundations.HLevels</a>

<a id="683" class="Keyword">open</a> <a id="688" class="Keyword">import</a> <a id="695" href="Cubical.Data.Nat.html" class="Module">Cubical.Data.Nat</a>
  <a id="714" class="Keyword">hiding</a>   <a id="723" class="Symbol">(</a><a id="724" href="Cubical.Data.Nat.Base.html#216" class="Primitive Operator">_·_</a><a id="727" class="Symbol">)</a>
  <a id="731" class="Keyword">renaming</a> <a id="740" class="Symbol">(</a><a id="741" href="Agda.Builtin.Nat.html#325" class="Primitive Operator">_+_</a> <a id="745" class="Symbol">to</a> <a id="748" class="Primitive Operator">_+ℕ_</a> <a id="753" class="Symbol">;</a> <a id="755" href="Cubical.Data.Nat.Properties.html#1906" class="Function">+-assoc</a> <a id="763" class="Symbol">to</a> <a id="766" class="Function">+Assocℕ</a><a id="773" class="Symbol">)</a>
<a id="775" class="Keyword">open</a> <a id="780" class="Keyword">import</a> <a id="787" href="Cubical.Data.Nat.Order.html" class="Module">Cubical.Data.Nat.Order</a>
<a id="810" class="Keyword">open</a> <a id="815" class="Keyword">import</a> <a id="822" href="Cubical.Data.Nat.Divisibility.html" class="Module">Cubical.Data.Nat.Divisibility</a>
  <a id="854" class="Keyword">using</a>    <a id="863" class="Symbol">(</a><a id="864" href="Cubical.Data.Nat.Divisibility.html#2638" class="Function">m∣n→m≤n</a><a id="871" class="Symbol">)</a>
  <a id="875" class="Keyword">renaming</a> <a id="884" class="Symbol">(</a><a id="885" href="Cubical.Data.Nat.Divisibility.html#1543" class="Function">∣-trans</a> <a id="893" class="Symbol">to</a> <a id="896" class="Function">∣ℕ-trans</a> <a id="905" class="Symbol">;</a> <a id="907" href="Cubical.Data.Nat.Divisibility.html#1487" class="Function">∣-refl</a> <a id="914" class="Symbol">to</a> <a id="917" class="Function">∣-reflℕ</a><a id="924" class="Symbol">)</a>
<a id="926" class="Keyword">open</a> <a id="931" class="Keyword">import</a> <a id="938" href="Cubical.Data.Int.html" class="Module">Cubical.Data.Int</a>
  <a id="957" class="Keyword">hiding</a>   <a id="966" class="Symbol">(</a><a id="967" href="Cubical.Data.Int.Base.html#1181" class="Function Operator">_+_</a> <a id="971" class="Symbol">;</a> <a id="973" href="Cubical.Data.Int.Base.html#1365" class="Function Operator">_·_</a> <a id="977" class="Symbol">;</a> <a id="979" href="Cubical.Data.Int.Base.html#1330" class="Function Operator">_-_</a> <a id="983" class="Symbol">;</a> <a id="985" href="Cubical.Data.Int.Base.html#1246" class="Function Operator">-_</a> <a id="988" class="Symbol">;</a> <a id="990" href="Cubical.Data.Int.Properties.html#6457" class="Function">addEq</a><a id="995" class="Symbol">)</a>
<a id="997" class="Keyword">open</a> <a id="1002" class="Keyword">import</a> <a id="1009" href="Cubical.Data.Int.Divisibility.html" class="Module">Cubical.Data.Int.Divisibility</a>
<a id="1039" class="Keyword">open</a> <a id="1044" class="Keyword">import</a> <a id="1051" href="Cubical.Data.FinData.html" class="Module">Cubical.Data.FinData</a>

<a id="1073" class="Keyword">open</a> <a id="1078" class="Keyword">import</a> <a id="1085" href="Cubical.Data.Empty.html" class="Module">Cubical.Data.Empty</a> <a id="1104" class="Symbol">as</a> <a id="1107" class="Module">Empty</a>
<a id="1113" class="Keyword">open</a> <a id="1118" class="Keyword">import</a> <a id="1125" href="Cubical.Data.Unit.html" class="Module">Cubical.Data.Unit</a>  <a id="1144" class="Symbol">as</a> <a id="1147" class="Module">Unit</a>
<a id="1152" class="Keyword">open</a> <a id="1157" class="Keyword">import</a> <a id="1164" href="Cubical.Data.Sum.html" class="Module">Cubical.Data.Sum</a>
<a id="1181" class="Keyword">open</a> <a id="1186" class="Keyword">import</a> <a id="1193" href="Cubical.Data.Sigma.html" class="Module">Cubical.Data.Sigma</a>
<a id="1212" class="Keyword">open</a> <a id="1217" class="Keyword">import</a> <a id="1224" href="Cubical.Data.List.html" class="Module">Cubical.Data.List</a>

<a id="1243" class="Keyword">open</a> <a id="1248" class="Keyword">import</a> <a id="1255" href="Cubical.Algebra.Matrix.html" class="Module">Cubical.Algebra.Matrix</a>
<a id="1278" class="Keyword">open</a> <a id="1283" class="Keyword">import</a> <a id="1290" href="Cubical.Algebra.Matrix.CommRingCoefficient.html" class="Module">Cubical.Algebra.Matrix.CommRingCoefficient</a>
<a id="1333" class="Keyword">open</a> <a id="1338" class="Keyword">import</a> <a id="1345" href="Cubical.Algebra.Matrix.Elementaries.html" class="Module">Cubical.Algebra.Matrix.Elementaries</a>
<a id="1381" class="Keyword">open</a> <a id="1386" class="Keyword">import</a> <a id="1393" href="Cubical.Algebra.IntegerMatrix.Base.html" class="Module">Cubical.Algebra.IntegerMatrix.Base</a>
<a id="1428" class="Keyword">open</a> <a id="1433" class="Keyword">import</a> <a id="1440" href="Cubical.Algebra.IntegerMatrix.Elementaries.html" class="Module">Cubical.Algebra.IntegerMatrix.Elementaries</a>

<a id="1484" class="Keyword">open</a> <a id="1489" class="Keyword">import</a> <a id="1496" href="Cubical.Algebra.CommRing.html" class="Module">Cubical.Algebra.CommRing</a>
<a id="1521" class="Keyword">open</a> <a id="1526" class="Keyword">import</a> <a id="1533" href="Cubical.Algebra.CommRing.Instances.Int.html" class="Module">Cubical.Algebra.CommRing.Instances.Int</a>
  <a id="1574" class="Keyword">renaming</a> <a id="1583" class="Symbol">(</a><a id="1584" href="Cubical.Algebra.CommRing.Instances.Int.html#273" class="Function">ℤ</a> <a id="1586" class="Symbol">to</a> <a id="1589" class="Function">ℤRing</a><a id="1594" class="Symbol">)</a>

<a id="1597" class="Keyword">open</a> <a id="1602" class="Keyword">import</a> <a id="1609" href="Cubical.Relation.Nullary.html" class="Module">Cubical.Relation.Nullary</a>
<a id="1634" class="Keyword">open</a> <a id="1639" class="Keyword">import</a> <a id="1646" href="Cubical.Induction.WellFounded.html" class="Module">Cubical.Induction.WellFounded</a>

<a id="1677" class="Keyword">private</a>
  <a id="1687" class="Keyword">variable</a>
    <a id="1700" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#1700" class="Generalizable">m</a> <a id="1702" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#1702" class="Generalizable">n</a> <a id="1704" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#1704" class="Generalizable">k</a> <a id="1706" class="Symbol">:</a> <a id="1708" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a>

<a id="1711" class="Keyword">open</a> <a id="1716" href="Cubical.Algebra.CommRing.Base.html#1034" class="Module">CommRingStr</a>      <a id="1733" class="Symbol">(</a><a id="1734" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#1589" class="Function">ℤRing</a> <a id="1740" class="Symbol">.</a><a id="1741" href="Agda.Builtin.Sigma.html#264" class="Field">snd</a><a id="1744" class="Symbol">)</a>

<a id="1747" class="Keyword">open</a> <a id="1752" href="Cubical.Algebra.Matrix.CommRingCoefficient.html#742" class="Module">Coefficient</a> <a id="1764" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#1589" class="Function">ℤRing</a>
<a id="1770" class="Keyword">open</a> <a id="1775" href="Cubical.Algebra.Matrix.CommRingCoefficient.html#6605" class="Module">Sim</a>

<a id="1780" class="Keyword">open</a> <a id="1785" href="Cubical.Algebra.Matrix.Elementaries.html#833" class="Module">ElemTransformation</a> <a id="1804" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#1589" class="Function">ℤRing</a>
<a id="1810" class="Keyword">open</a> <a id="1815" href="Cubical.Algebra.IntegerMatrix.Elementaries.html#1134" class="Module">ElemTransformationℤ</a>
<a id="1835" class="Keyword">open</a> <a id="1840" href="Cubical.Algebra.Matrix.Elementaries.html#5411" class="Module">SwapPivot</a>
<a id="1850" class="Keyword">open</a> <a id="1855" href="Cubical.Algebra.IntegerMatrix.Elementaries.html#7719" class="Module">RowsImproved</a>
<a id="1868" class="Keyword">open</a> <a id="1873" href="Cubical.Algebra.IntegerMatrix.Elementaries.html#7982" class="Module">ColsImproved</a>

<a id="1887" class="Comment">-- Sequence of non-zero integers</a>

<a id="isNonZero"></a><a id="1921" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#1921" class="Function">isNonZero</a> <a id="1931" class="Symbol">:</a> <a id="1933" href="Agda.Builtin.List.html#148" class="Datatype">List</a> <a id="1938" href="Cubical.Data.Int.Base.html#393" class="Datatype">ℤ</a> <a id="1940" class="Symbol">→</a> <a id="1942" href="Agda.Primitive.html#326" class="Primitive">Type</a>
<a id="1947" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#1921" class="Function">isNonZero</a> <a id="1957" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a> <a id="1960" class="Symbol">=</a> <a id="1962" href="Cubical.Data.Unit.Base.html#171" class="Record">Unit</a>
<a id="1967" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#1921" class="Function">isNonZero</a> <a id="1977" class="Symbol">(</a><a id="1978" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#1978" class="Bound">x</a> <a id="1980" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="1982" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#1982" class="Bound">xs</a><a id="1984" class="Symbol">)</a> <a id="1986" class="Symbol">=</a> <a id="1988" class="Symbol">(</a><a id="1989" href="Cubical.Relation.Nullary.Base.html#355" class="Function Operator">¬</a> <a id="1991" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#1978" class="Bound">x</a> <a id="1993" href="Agda.Builtin.Cubical.Path.html#381" class="Function Operator">≡</a> <a id="1995" class="Number">0</a><a id="1996" class="Symbol">)</a> <a id="1998" href="Cubical.Data.Sigma.Base.html#461" class="Function Operator">×</a> <a id="2000" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#1921" class="Function">isNonZero</a> <a id="2010" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#1982" class="Bound">xs</a>

<a id="isPropIsNonZero"></a><a id="2014" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#2014" class="Function">isPropIsNonZero</a> <a id="2030" class="Symbol">:</a> <a id="2032" class="Symbol">(</a><a id="2033" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#2033" class="Bound">xs</a> <a id="2036" class="Symbol">:</a> <a id="2038" href="Agda.Builtin.List.html#148" class="Datatype">List</a> <a id="2043" href="Cubical.Data.Int.Base.html#393" class="Datatype">ℤ</a><a id="2044" class="Symbol">)</a> <a id="2046" class="Symbol">→</a> <a id="2048" href="Cubical.Foundations.Prelude.html#11735" class="Function">isProp</a> <a id="2055" class="Symbol">(</a><a id="2056" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#1921" class="Function">isNonZero</a> <a id="2066" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#2033" class="Bound">xs</a><a id="2068" class="Symbol">)</a>
<a id="2070" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#2014" class="Function">isPropIsNonZero</a> <a id="2086" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a> <a id="2089" class="Symbol">=</a> <a id="2091" href="Cubical.Data.Unit.Properties.html#686" class="Function">isPropUnit</a>
<a id="2102" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#2014" class="Function">isPropIsNonZero</a> <a id="2118" class="Symbol">(</a><a id="2119" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#2119" class="Bound">x</a> <a id="2121" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="2123" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#2123" class="Bound">xs</a><a id="2125" class="Symbol">)</a> <a id="2127" class="Symbol">=</a> <a id="2129" href="Cubical.Foundations.HLevels.html#13193" class="Function">isProp×</a> <a id="2137" class="Symbol">(</a><a id="2138" href="Cubical.Foundations.HLevels.html#16241" class="Function">isPropΠ</a> <a id="2146" class="Symbol">(λ</a> <a id="2149" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#2149" class="Bound">_</a> <a id="2151" class="Symbol">→</a> <a id="2153" href="Cubical.Data.Empty.Properties.html#228" class="Function">isProp⊥</a><a id="2160" class="Symbol">))</a> <a id="2163" class="Symbol">(</a><a id="2164" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#2014" class="Function">isPropIsNonZero</a> <a id="2180" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#2123" class="Bound">xs</a><a id="2182" class="Symbol">)</a>

<a id="NonZeroList"></a><a id="2185" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#2185" class="Function">NonZeroList</a> <a id="2197" class="Symbol">:</a> <a id="2199" href="Agda.Primitive.html#326" class="Primitive">Type</a>
<a id="2204" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#2185" class="Function">NonZeroList</a> <a id="2216" class="Symbol">=</a> <a id="2218" href="Cubical.Core.Primitives.html#6274" class="Function">Σ[</a> <a id="2221" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#2221" class="Bound">xs</a> <a id="2224" href="Cubical.Core.Primitives.html#6274" class="Function">∈</a> <a id="2226" href="Agda.Builtin.List.html#148" class="Datatype">List</a> <a id="2231" href="Cubical.Data.Int.Base.html#393" class="Datatype">ℤ</a> <a id="2233" href="Cubical.Core.Primitives.html#6274" class="Function">]</a> <a id="2235" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#1921" class="Function">isNonZero</a> <a id="2245" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#2221" class="Bound">xs</a>

<a id="cons"></a><a id="2249" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#2249" class="Function">cons</a> <a id="2254" class="Symbol">:</a> <a id="2256" class="Symbol">(</a><a id="2257" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#2257" class="Bound">n</a> <a id="2259" class="Symbol">:</a> <a id="2261" href="Cubical.Data.Int.Base.html#393" class="Datatype">ℤ</a><a id="2262" class="Symbol">)(</a><a id="2264" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#2264" class="Bound">xs</a> <a id="2267" class="Symbol">:</a> <a id="2269" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#2185" class="Function">NonZeroList</a><a id="2280" class="Symbol">)</a> <a id="2282" class="Symbol">→</a> <a id="2284" href="Cubical.Relation.Nullary.Base.html#355" class="Function Operator">¬</a> <a id="2286" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#2257" class="Bound">n</a> <a id="2288" href="Agda.Builtin.Cubical.Path.html#381" class="Function Operator">≡</a> <a id="2290" class="Number">0</a> <a id="2292" class="Symbol">→</a> <a id="2294" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#2185" class="Function">NonZeroList</a>
<a id="2306" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#2249" class="Function">cons</a> <a id="2311" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#2311" class="Bound">n</a> <a id="2313" class="Symbol">(</a><a id="2314" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#2314" class="Bound">xs</a> <a id="2317" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="2319" class="Symbol">_)</a> <a id="2322" class="Symbol">_</a> <a id="2324" class="Symbol">.</a><a id="2325" href="Agda.Builtin.Sigma.html#252" class="Field">fst</a> <a id="2329" class="Symbol">=</a> <a id="2331" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#2311" class="Bound">n</a> <a id="2333" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="2335" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#2314" class="Bound">xs</a>
<a id="2338" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#2249" class="Function">cons</a> <a id="2343" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#2343" class="Bound">n</a> <a id="2345" class="Symbol">(</a><a id="2346" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a> <a id="2349" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="2351" class="Symbol">_)</a> <a id="2354" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#2354" class="Bound">p</a> <a id="2356" class="Symbol">.</a><a id="2357" href="Agda.Builtin.Sigma.html#264" class="Field">snd</a> <a id="2361" class="Symbol">=</a> <a id="2363" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#2354" class="Bound">p</a> <a id="2365" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="2367" href="Agda.Builtin.Unit.html#201" class="InductiveConstructor">tt</a>
<a id="2370" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#2249" class="Function">cons</a> <a id="2375" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#2375" class="Bound">n</a> <a id="2377" class="Symbol">(</a><a id="2378" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#2378" class="Bound">x</a> <a id="2380" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="2382" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#2382" class="Bound">xs</a> <a id="2385" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="2387" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#2387" class="Bound">q</a><a id="2388" class="Symbol">)</a> <a id="2390" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#2390" class="Bound">p</a> <a id="2392" class="Symbol">.</a><a id="2393" href="Agda.Builtin.Sigma.html#264" class="Field">snd</a> <a id="2397" class="Symbol">=</a> <a id="2399" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#2390" class="Bound">p</a> <a id="2401" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="2403" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#2387" class="Bound">q</a>

<a id="2406" class="Comment">-- Smith normal matrix</a>

<a id="_+length_"></a><a id="2430" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#2430" class="Function Operator">_+length_</a> <a id="2440" class="Symbol">:</a> <a id="2442" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#2185" class="Function">NonZeroList</a> <a id="2454" class="Symbol">→</a> <a id="2456" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a> <a id="2458" class="Symbol">→</a> <a id="2460" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a>
<a id="2462" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#2462" class="Bound">xs</a> <a id="2465" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#2430" class="Function Operator">+length</a> <a id="2473" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#2473" class="Bound">n</a> <a id="2475" class="Symbol">=</a> <a id="2477" href="Cubical.Data.List.Base.html#529" class="Function">length</a> <a id="2484" class="Symbol">(</a><a id="2485" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#2462" class="Bound">xs</a> <a id="2488" class="Symbol">.</a><a id="2489" href="Agda.Builtin.Sigma.html#252" class="Field">fst</a><a id="2492" class="Symbol">)</a> <a id="2494" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#748" class="Primitive Operator">+ℕ</a> <a id="2497" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#2473" class="Bound">n</a>

<a id="diagMat"></a><a id="2500" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#2500" class="Function">diagMat</a> <a id="2508" class="Symbol">:</a> <a id="2510" class="Symbol">(</a><a id="2511" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#2511" class="Bound">xs</a> <a id="2514" class="Symbol">:</a> <a id="2516" href="Agda.Builtin.List.html#148" class="Datatype">List</a> <a id="2521" href="Cubical.Data.Int.Base.html#393" class="Datatype">ℤ</a><a id="2522" class="Symbol">)(</a><a id="2524" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#2524" class="Bound">m</a> <a id="2526" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#2526" class="Bound">n</a> <a id="2528" class="Symbol">:</a> <a id="2530" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a><a id="2531" class="Symbol">)</a> <a id="2533" class="Symbol">→</a> <a id="2535" href="Cubical.Algebra.Matrix.CommRingCoefficient.html#999" class="Function">Mat</a> <a id="2539" class="Symbol">(</a><a id="2540" href="Cubical.Data.List.Base.html#529" class="Function">length</a> <a id="2547" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#2511" class="Bound">xs</a> <a id="2550" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#748" class="Primitive Operator">+ℕ</a> <a id="2553" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#2524" class="Bound">m</a><a id="2554" class="Symbol">)</a> <a id="2556" class="Symbol">(</a><a id="2557" href="Cubical.Data.List.Base.html#529" class="Function">length</a> <a id="2564" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#2511" class="Bound">xs</a> <a id="2567" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#748" class="Primitive Operator">+ℕ</a> <a id="2570" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#2526" class="Bound">n</a><a id="2571" class="Symbol">)</a>
<a id="2573" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#2500" class="Function">diagMat</a> <a id="2581" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a> <a id="2584" class="Symbol">_</a> <a id="2586" class="Symbol">_</a> <a id="2588" class="Symbol">=</a> <a id="2590" href="Cubical.Algebra.Matrix.CommRingCoefficient.html#1482" class="Function">𝟘</a>
<a id="2592" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#2500" class="Function">diagMat</a> <a id="2600" class="Symbol">(</a><a id="2601" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#2601" class="Bound">x</a> <a id="2603" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="2605" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#2605" class="Bound">xs</a><a id="2607" class="Symbol">)</a> <a id="2609" class="Symbol">_</a> <a id="2611" class="Symbol">_</a> <a id="2613" class="Symbol">=</a> <a id="2615" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#2601" class="Bound">x</a> <a id="2617" href="Cubical.Algebra.Matrix.CommRingCoefficient.html#8427" class="Function Operator">⊕</a> <a id="2619" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#2500" class="Function">diagMat</a> <a id="2627" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#2605" class="Bound">xs</a> <a id="2630" class="Symbol">_</a> <a id="2632" class="Symbol">_</a>

<a id="diagMat⊕"></a><a id="2635" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#2635" class="Function">diagMat⊕</a> <a id="2644" class="Symbol">:</a>
    <a id="2650" class="Symbol">(</a><a id="2651" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#2651" class="Bound">a</a> <a id="2653" class="Symbol">:</a> <a id="2655" href="Cubical.Data.Int.Base.html#393" class="Datatype">ℤ</a><a id="2656" class="Symbol">)(</a><a id="2658" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#2658" class="Bound">xs</a> <a id="2661" class="Symbol">:</a> <a id="2663" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#2185" class="Function">NonZeroList</a><a id="2674" class="Symbol">){</a><a id="2676" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#2676" class="Bound">m</a> <a id="2678" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#2678" class="Bound">n</a> <a id="2680" class="Symbol">:</a> <a id="2682" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a><a id="2683" class="Symbol">}</a>
  <a id="2687" class="Symbol">→</a> <a id="2689" class="Symbol">(</a><a id="2690" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#2690" class="Bound">p</a> <a id="2692" class="Symbol">:</a> <a id="2694" href="Cubical.Relation.Nullary.Base.html#355" class="Function Operator">¬</a> <a id="2696" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#2651" class="Bound">a</a> <a id="2698" href="Agda.Builtin.Cubical.Path.html#381" class="Function Operator">≡</a> <a id="2700" class="Number">0</a><a id="2701" class="Symbol">)</a>
  <a id="2705" class="Symbol">→</a> <a id="2707" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#2651" class="Bound">a</a> <a id="2709" href="Cubical.Algebra.Matrix.CommRingCoefficient.html#8427" class="Function Operator">⊕</a> <a id="2711" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#2500" class="Function">diagMat</a> <a id="2719" class="Symbol">(</a><a id="2720" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#2658" class="Bound">xs</a> <a id="2723" class="Symbol">.</a><a id="2724" href="Agda.Builtin.Sigma.html#252" class="Field">fst</a><a id="2727" class="Symbol">)</a> <a id="2729" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#2676" class="Bound">m</a> <a id="2731" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#2678" class="Bound">n</a> <a id="2733" href="Agda.Builtin.Cubical.Path.html#381" class="Function Operator">≡</a> <a id="2735" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#2500" class="Function">diagMat</a> <a id="2743" class="Symbol">(</a><a id="2744" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#2249" class="Function">cons</a> <a id="2749" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#2651" class="Bound">a</a> <a id="2751" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#2658" class="Bound">xs</a> <a id="2754" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#2690" class="Bound">p</a> <a id="2756" class="Symbol">.</a><a id="2757" href="Agda.Builtin.Sigma.html#252" class="Field">fst</a><a id="2760" class="Symbol">)</a> <a id="2762" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#2676" class="Bound">m</a> <a id="2764" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#2678" class="Bound">n</a>
<a id="2766" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#2635" class="Function">diagMat⊕</a> <a id="2775" class="Symbol">_</a> <a id="2777" class="Symbol">_</a> <a id="2779" class="Symbol">_</a> <a id="2781" class="Symbol">=</a> <a id="2783" href="Cubical.Foundations.Prelude.html#889" class="Function">refl</a>

<a id="2789" class="Comment">-- Diagonal matrix with non-zero diagonal elements</a>
<a id="2840" class="Comment">-- Notice that we allow non-square matrices.</a>

<a id="2886" class="Keyword">record</a> <a id="isDiagonal"></a><a id="2893" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#2893" class="Record">isDiagonal</a> <a id="2904" class="Symbol">(</a><a id="2905" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#2905" class="Bound">M</a> <a id="2907" class="Symbol">:</a> <a id="2909" href="Cubical.Algebra.Matrix.CommRingCoefficient.html#999" class="Function">Mat</a> <a id="2913" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#1700" class="Generalizable">m</a> <a id="2915" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#1702" class="Generalizable">n</a><a id="2916" class="Symbol">)</a> <a id="2918" class="Symbol">:</a> <a id="2920" href="Agda.Primitive.html#326" class="Primitive">Type</a> <a id="2925" class="Keyword">where</a>
  <a id="2933" class="Keyword">field</a>
    <a id="isDiagonal.divs"></a><a id="2943" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#2943" class="Field">divs</a> <a id="2948" class="Symbol">:</a> <a id="2950" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#2185" class="Function">NonZeroList</a>
    <a id="isDiagonal.rowNull"></a><a id="2966" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#2966" class="Field">rowNull</a> <a id="2974" class="Symbol">:</a> <a id="2976" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a>
    <a id="isDiagonal.colNull"></a><a id="2982" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#2982" class="Field">colNull</a> <a id="2990" class="Symbol">:</a> <a id="2992" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a>

    <a id="isDiagonal.rowEq"></a><a id="2999" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#2999" class="Field">rowEq</a> <a id="3005" class="Symbol">:</a> <a id="3007" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#2943" class="Field">divs</a> <a id="3012" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#2430" class="Function Operator">+length</a> <a id="3020" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#2966" class="Field">rowNull</a> <a id="3028" href="Agda.Builtin.Cubical.Path.html#381" class="Function Operator">≡</a> <a id="3030" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#2913" class="Bound">m</a>
    <a id="isDiagonal.colEq"></a><a id="3036" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#3036" class="Field">colEq</a> <a id="3042" class="Symbol">:</a> <a id="3044" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#2943" class="Field">divs</a> <a id="3049" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#2430" class="Function Operator">+length</a> <a id="3057" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#2982" class="Field">colNull</a> <a id="3065" href="Agda.Builtin.Cubical.Path.html#381" class="Function Operator">≡</a> <a id="3067" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#2915" class="Bound">n</a>
    <a id="isDiagonal.matEq"></a><a id="3073" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#3073" class="Field">matEq</a> <a id="3079" class="Symbol">:</a> <a id="3081" href="Agda.Builtin.Cubical.Path.html#190" class="Postulate">PathP</a> <a id="3087" class="Symbol">(λ</a> <a id="3090" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#3090" class="Bound">t</a> <a id="3092" class="Symbol">→</a> <a id="3094" href="Cubical.Algebra.Matrix.CommRingCoefficient.html#999" class="Function">Mat</a> <a id="3098" class="Symbol">(</a><a id="3099" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#2999" class="Field">rowEq</a> <a id="3105" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#3090" class="Bound">t</a><a id="3106" class="Symbol">)</a> <a id="3108" class="Symbol">(</a><a id="3109" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#3036" class="Field">colEq</a> <a id="3115" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#3090" class="Bound">t</a><a id="3116" class="Symbol">))</a> <a id="3119" class="Symbol">(</a><a id="3120" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#2500" class="Function">diagMat</a> <a id="3128" class="Symbol">(</a><a id="3129" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#2943" class="Field">divs</a> <a id="3134" class="Symbol">.</a><a id="3135" href="Agda.Builtin.Sigma.html#252" class="Field">fst</a><a id="3138" class="Symbol">)</a> <a id="3140" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#2966" class="Field">rowNull</a> <a id="3148" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#2982" class="Field">colNull</a><a id="3155" class="Symbol">)</a> <a id="3157" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#2905" class="Bound">M</a>

<a id="3160" class="Keyword">open</a> <a id="3165" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#2893" class="Module">isDiagonal</a>

<a id="row"></a><a id="3177" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#3177" class="Function">row</a> <a id="col"></a><a id="3181" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#3181" class="Function">col</a> <a id="3185" class="Symbol">:</a> <a id="3187" class="Symbol">{</a><a id="3188" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#3188" class="Bound">M</a> <a id="3190" class="Symbol">:</a> <a id="3192" href="Cubical.Algebra.Matrix.CommRingCoefficient.html#999" class="Function">Mat</a> <a id="3196" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#1700" class="Generalizable">m</a> <a id="3198" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#1702" class="Generalizable">n</a><a id="3199" class="Symbol">}</a> <a id="3201" class="Symbol">→</a> <a id="3203" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#2893" class="Record">isDiagonal</a> <a id="3214" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#3188" class="Bound">M</a> <a id="3216" class="Symbol">→</a> <a id="3218" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a>
<a id="3220" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#3177" class="Function">row</a> <a id="3224" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#3224" class="Bound">isNorm</a> <a id="3231" class="Symbol">=</a> <a id="3233" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#3224" class="Bound">isNorm</a> <a id="3240" class="Symbol">.</a><a id="3241" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#2943" class="Field">divs</a> <a id="3246" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#2430" class="Function Operator">+length</a> <a id="3254" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#3224" class="Bound">isNorm</a> <a id="3261" class="Symbol">.</a><a id="3262" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#2966" class="Field">rowNull</a>
<a id="3270" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#3181" class="Function">col</a> <a id="3274" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#3274" class="Bound">isNorm</a> <a id="3281" class="Symbol">=</a> <a id="3283" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#3274" class="Bound">isNorm</a> <a id="3290" class="Symbol">.</a><a id="3291" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#2943" class="Field">divs</a> <a id="3296" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#2430" class="Function Operator">+length</a> <a id="3304" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#3274" class="Bound">isNorm</a> <a id="3311" class="Symbol">.</a><a id="3312" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#2982" class="Field">colNull</a>

<a id="isDiagonal𝟘"></a><a id="3321" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#3321" class="Function">isDiagonal𝟘</a> <a id="3333" class="Symbol">:</a> <a id="3335" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#2893" class="Record">isDiagonal</a> <a id="3346" class="Symbol">(</a><a id="3347" href="Cubical.Algebra.Matrix.CommRingCoefficient.html#1482" class="Function">𝟘</a> <a id="3349" class="Symbol">{</a><a id="3350" class="Argument">m</a> <a id="3352" class="Symbol">=</a> <a id="3354" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#1700" class="Generalizable">m</a><a id="3355" class="Symbol">}</a> <a id="3357" class="Symbol">{</a><a id="3358" class="Argument">n</a> <a id="3360" class="Symbol">=</a> <a id="3362" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#1702" class="Generalizable">n</a><a id="3363" class="Symbol">})</a>
<a id="3366" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#3321" class="Function">isDiagonal𝟘</a> <a id="3378" class="Symbol">.</a><a id="3379" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#2943" class="Field">divs</a> <a id="3384" class="Symbol">=</a> <a id="3386" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a> <a id="3389" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="3391" href="Agda.Builtin.Unit.html#201" class="InductiveConstructor">tt</a>
<a id="3394" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#3321" class="Function">isDiagonal𝟘</a> <a id="3406" class="Symbol">{</a><a id="3407" class="Argument">m</a> <a id="3409" class="Symbol">=</a> <a id="3411" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#3411" class="Bound">m</a><a id="3412" class="Symbol">}</a> <a id="3414" class="Symbol">.</a><a id="3415" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#2966" class="Field">rowNull</a> <a id="3423" class="Symbol">=</a> <a id="3425" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#3411" class="Bound">m</a>
<a id="3427" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#3321" class="Function">isDiagonal𝟘</a> <a id="3439" class="Symbol">{</a><a id="3440" class="Argument">n</a> <a id="3442" class="Symbol">=</a> <a id="3444" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#3444" class="Bound">n</a><a id="3445" class="Symbol">}</a> <a id="3447" class="Symbol">.</a><a id="3448" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#2982" class="Field">colNull</a> <a id="3456" class="Symbol">=</a> <a id="3458" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#3444" class="Bound">n</a>
<a id="3460" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#3321" class="Function">isDiagonal𝟘</a> <a id="3472" class="Symbol">.</a><a id="3473" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#2999" class="Field">rowEq</a> <a id="3479" class="Symbol">=</a> <a id="3481" href="Cubical.Foundations.Prelude.html#889" class="Function">refl</a>
<a id="3486" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#3321" class="Function">isDiagonal𝟘</a> <a id="3498" class="Symbol">.</a><a id="3499" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#3036" class="Field">colEq</a> <a id="3505" class="Symbol">=</a> <a id="3507" href="Cubical.Foundations.Prelude.html#889" class="Function">refl</a>
<a id="3512" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#3321" class="Function">isDiagonal𝟘</a> <a id="3524" class="Symbol">.</a><a id="3525" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#3073" class="Field">matEq</a> <a id="3531" class="Symbol">=</a> <a id="3533" href="Cubical.Foundations.Prelude.html#889" class="Function">refl</a>

<a id="isDiagonalEmpty"></a><a id="3539" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#3539" class="Function">isDiagonalEmpty</a> <a id="3555" class="Symbol">:</a> <a id="3557" class="Symbol">(</a><a id="3558" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#3558" class="Bound">M</a> <a id="3560" class="Symbol">:</a> <a id="3562" href="Cubical.Algebra.Matrix.CommRingCoefficient.html#999" class="Function">Mat</a> <a id="3566" class="Number">0</a> <a id="3568" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#1702" class="Generalizable">n</a><a id="3569" class="Symbol">)</a> <a id="3571" class="Symbol">→</a> <a id="3573" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#2893" class="Record">isDiagonal</a> <a id="3584" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#3558" class="Bound">M</a>
<a id="3586" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#3539" class="Function">isDiagonalEmpty</a> <a id="3602" class="Symbol">_</a> <a id="3604" class="Symbol">.</a><a id="3605" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#2943" class="Field">divs</a> <a id="3610" class="Symbol">=</a> <a id="3612" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a> <a id="3615" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="3617" href="Agda.Builtin.Unit.html#201" class="InductiveConstructor">tt</a>
<a id="3620" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#3539" class="Function">isDiagonalEmpty</a> <a id="3636" class="Symbol">_</a> <a id="3638" class="Symbol">.</a><a id="3639" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#2966" class="Field">rowNull</a> <a id="3647" class="Symbol">=</a> <a id="3649" class="Number">0</a>
<a id="3651" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#3539" class="Function">isDiagonalEmpty</a> <a id="3667" class="Symbol">{</a><a id="3668" class="Argument">n</a> <a id="3670" class="Symbol">=</a> <a id="3672" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#3672" class="Bound">n</a><a id="3673" class="Symbol">}</a> <a id="3675" class="Symbol">_</a> <a id="3677" class="Symbol">.</a><a id="3678" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#2982" class="Field">colNull</a> <a id="3686" class="Symbol">=</a> <a id="3688" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#3672" class="Bound">n</a>
<a id="3690" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#3539" class="Function">isDiagonalEmpty</a> <a id="3706" class="Symbol">_</a> <a id="3708" class="Symbol">.</a><a id="3709" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#2999" class="Field">rowEq</a> <a id="3715" class="Symbol">=</a> <a id="3717" href="Cubical.Foundations.Prelude.html#889" class="Function">refl</a>
<a id="3722" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#3539" class="Function">isDiagonalEmpty</a> <a id="3738" class="Symbol">_</a> <a id="3740" class="Symbol">.</a><a id="3741" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#3036" class="Field">colEq</a> <a id="3747" class="Symbol">=</a> <a id="3749" href="Cubical.Foundations.Prelude.html#889" class="Function">refl</a>
<a id="3754" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#3539" class="Function">isDiagonalEmpty</a> <a id="3770" class="Symbol">_</a> <a id="3772" class="Symbol">.</a><a id="3773" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#3073" class="Field">matEq</a> <a id="3779" class="Symbol">=</a> <a id="3781" href="Cubical.Foundations.Prelude.html#15838" class="Function">isContr→isProp</a> <a id="3796" href="Cubical.Algebra.Matrix.CommRingCoefficient.html#1123" class="Function">isContrEmpty</a> <a id="3809" class="Symbol">_</a> <a id="3811" class="Symbol">_</a>

<a id="isDiagonalEmptyᵗ"></a><a id="3814" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#3814" class="Function">isDiagonalEmptyᵗ</a> <a id="3831" class="Symbol">:</a> <a id="3833" class="Symbol">(</a><a id="3834" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#3834" class="Bound">M</a> <a id="3836" class="Symbol">:</a> <a id="3838" href="Cubical.Algebra.Matrix.CommRingCoefficient.html#999" class="Function">Mat</a> <a id="3842" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#1700" class="Generalizable">m</a> <a id="3844" class="Number">0</a><a id="3845" class="Symbol">)</a> <a id="3847" class="Symbol">→</a> <a id="3849" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#2893" class="Record">isDiagonal</a> <a id="3860" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#3834" class="Bound">M</a>
<a id="3862" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#3814" class="Function">isDiagonalEmptyᵗ</a> <a id="3879" class="Symbol">_</a> <a id="3881" class="Symbol">.</a><a id="3882" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#2943" class="Field">divs</a> <a id="3887" class="Symbol">=</a> <a id="3889" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a> <a id="3892" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="3894" href="Agda.Builtin.Unit.html#201" class="InductiveConstructor">tt</a>
<a id="3897" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#3814" class="Function">isDiagonalEmptyᵗ</a> <a id="3914" class="Symbol">{</a><a id="3915" class="Argument">m</a> <a id="3917" class="Symbol">=</a> <a id="3919" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#3919" class="Bound">m</a><a id="3920" class="Symbol">}</a> <a id="3922" class="Symbol">_</a> <a id="3924" class="Symbol">.</a><a id="3925" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#2966" class="Field">rowNull</a> <a id="3933" class="Symbol">=</a> <a id="3935" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#3919" class="Bound">m</a>
<a id="3937" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#3814" class="Function">isDiagonalEmptyᵗ</a> <a id="3954" class="Symbol">_</a> <a id="3956" class="Symbol">.</a><a id="3957" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#2982" class="Field">colNull</a> <a id="3965" class="Symbol">=</a> <a id="3967" class="Number">0</a>
<a id="3969" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#3814" class="Function">isDiagonalEmptyᵗ</a> <a id="3986" class="Symbol">_</a> <a id="3988" class="Symbol">.</a><a id="3989" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#2999" class="Field">rowEq</a> <a id="3995" class="Symbol">=</a> <a id="3997" href="Cubical.Foundations.Prelude.html#889" class="Function">refl</a>
<a id="4002" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#3814" class="Function">isDiagonalEmptyᵗ</a> <a id="4019" class="Symbol">_</a> <a id="4021" class="Symbol">.</a><a id="4022" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#3036" class="Field">colEq</a> <a id="4028" class="Symbol">=</a> <a id="4030" href="Cubical.Foundations.Prelude.html#889" class="Function">refl</a>
<a id="4035" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#3814" class="Function">isDiagonalEmptyᵗ</a> <a id="4052" class="Symbol">_</a> <a id="4054" class="Symbol">.</a><a id="4055" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#3073" class="Field">matEq</a> <a id="4061" class="Symbol">=</a> <a id="4063" href="Cubical.Foundations.Prelude.html#15838" class="Function">isContr→isProp</a> <a id="4078" href="Cubical.Algebra.Matrix.CommRingCoefficient.html#1275" class="Function">isContrEmptyᵗ</a> <a id="4092" class="Symbol">_</a> <a id="4094" class="Symbol">_</a>


<a id="4098" class="Comment">-- Induction step towards diagonalization</a>

<a id="4141" class="Keyword">data</a> <a id="DivStatus"></a><a id="4146" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#4146" class="Datatype">DivStatus</a> <a id="4156" class="Symbol">(</a><a id="4157" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#4157" class="Bound">a</a> <a id="4159" class="Symbol">:</a> <a id="4161" href="Cubical.Data.Int.Base.html#393" class="Datatype">ℤ</a><a id="4162" class="Symbol">)(</a><a id="4164" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#4164" class="Bound">M</a> <a id="4166" class="Symbol">:</a> <a id="4168" href="Cubical.Algebra.Matrix.CommRingCoefficient.html#999" class="Function">Mat</a> <a id="4172" class="Symbol">(</a><a id="4173" href="Agda.Builtin.Nat.html#223" class="InductiveConstructor">suc</a> <a id="4177" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#1700" class="Generalizable">m</a><a id="4178" class="Symbol">)</a> <a id="4180" class="Symbol">(</a><a id="4181" href="Agda.Builtin.Nat.html#223" class="InductiveConstructor">suc</a> <a id="4185" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#1702" class="Generalizable">n</a><a id="4186" class="Symbol">))</a> <a id="4189" class="Symbol">:</a> <a id="4191" href="Agda.Primitive.html#326" class="Primitive">Type</a> <a id="4196" class="Keyword">where</a>
  <a id="DivStatus.badCol"></a><a id="4204" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#4204" class="InductiveConstructor">badCol</a>  <a id="4212" class="Symbol">:</a> <a id="4214" class="Symbol">(</a><a id="4215" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#4215" class="Bound">i</a> <a id="4217" class="Symbol">:</a> <a id="4219" href="Cubical.Data.FinData.Base.html#375" class="Datatype">Fin</a> <a id="4223" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#4177" class="Bound">m</a><a id="4224" class="Symbol">)(</a><a id="4226" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#4226" class="Bound">p</a> <a id="4228" class="Symbol">:</a> <a id="4230" href="Cubical.Relation.Nullary.Base.html#355" class="Function Operator">¬</a> <a id="4232" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#4157" class="Bound">a</a> <a id="4234" href="Cubical.Data.Int.Divisibility.html#1792" class="Function Operator">∣</a> <a id="4236" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#4164" class="Bound">M</a> <a id="4238" class="Symbol">(</a><a id="4239" href="Cubical.Data.FinData.Base.html#430" class="InductiveConstructor">suc</a> <a id="4243" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#4215" class="Bound">i</a><a id="4244" class="Symbol">)</a> <a id="4246" href="Cubical.Data.FinData.Base.html#399" class="InductiveConstructor">zero</a><a id="4250" class="Symbol">)</a> <a id="4252" class="Symbol">→</a> <a id="4254" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#4146" class="Datatype">DivStatus</a> <a id="4264" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#4157" class="Bound">a</a> <a id="4266" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#4164" class="Bound">M</a>
  <a id="DivStatus.badRow"></a><a id="4270" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#4270" class="InductiveConstructor">badRow</a>  <a id="4278" class="Symbol">:</a> <a id="4280" class="Symbol">(</a><a id="4281" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#4281" class="Bound">j</a> <a id="4283" class="Symbol">:</a> <a id="4285" href="Cubical.Data.FinData.Base.html#375" class="Datatype">Fin</a> <a id="4289" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#4185" class="Bound">n</a><a id="4290" class="Symbol">)(</a><a id="4292" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#4292" class="Bound">p</a> <a id="4294" class="Symbol">:</a> <a id="4296" href="Cubical.Relation.Nullary.Base.html#355" class="Function Operator">¬</a> <a id="4298" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#4157" class="Bound">a</a> <a id="4300" href="Cubical.Data.Int.Divisibility.html#1792" class="Function Operator">∣</a> <a id="4302" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#4164" class="Bound">M</a> <a id="4304" href="Cubical.Data.FinData.Base.html#399" class="InductiveConstructor">zero</a> <a id="4309" class="Symbol">(</a><a id="4310" href="Cubical.Data.FinData.Base.html#430" class="InductiveConstructor">suc</a> <a id="4314" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#4281" class="Bound">j</a><a id="4315" class="Symbol">))</a> <a id="4318" class="Symbol">→</a> <a id="4320" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#4146" class="Datatype">DivStatus</a> <a id="4330" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#4157" class="Bound">a</a> <a id="4332" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#4164" class="Bound">M</a>
  <a id="DivStatus.allDone"></a><a id="4336" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#4336" class="InductiveConstructor">allDone</a> <a id="4344" class="Symbol">:</a> <a id="4346" class="Symbol">((</a><a id="4348" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#4348" class="Bound">i</a> <a id="4350" class="Symbol">:</a> <a id="4352" href="Cubical.Data.FinData.Base.html#375" class="Datatype">Fin</a> <a id="4356" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#4177" class="Bound">m</a><a id="4357" class="Symbol">)</a> <a id="4359" class="Symbol">→</a> <a id="4361" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#4157" class="Bound">a</a> <a id="4363" href="Cubical.Data.Int.Divisibility.html#1792" class="Function Operator">∣</a> <a id="4365" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#4164" class="Bound">M</a> <a id="4367" class="Symbol">(</a><a id="4368" href="Cubical.Data.FinData.Base.html#430" class="InductiveConstructor">suc</a> <a id="4372" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#4348" class="Bound">i</a><a id="4373" class="Symbol">)</a> <a id="4375" href="Cubical.Data.FinData.Base.html#399" class="InductiveConstructor">zero</a><a id="4379" class="Symbol">)</a>
          <a id="4391" class="Symbol">→</a> <a id="4393" class="Symbol">((</a><a id="4395" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#4395" class="Bound">j</a> <a id="4397" class="Symbol">:</a> <a id="4399" href="Cubical.Data.FinData.Base.html#375" class="Datatype">Fin</a> <a id="4403" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#4185" class="Bound">n</a><a id="4404" class="Symbol">)</a> <a id="4406" class="Symbol">→</a> <a id="4408" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#4157" class="Bound">a</a> <a id="4410" href="Cubical.Data.Int.Divisibility.html#1792" class="Function Operator">∣</a> <a id="4412" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#4164" class="Bound">M</a> <a id="4414" href="Cubical.Data.FinData.Base.html#399" class="InductiveConstructor">zero</a> <a id="4419" class="Symbol">(</a><a id="4420" href="Cubical.Data.FinData.Base.html#430" class="InductiveConstructor">suc</a> <a id="4424" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#4395" class="Bound">j</a><a id="4425" class="Symbol">))</a> <a id="4428" class="Symbol">→</a> <a id="4430" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#4146" class="Datatype">DivStatus</a> <a id="4440" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#4157" class="Bound">a</a> <a id="4442" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#4164" class="Bound">M</a>

<a id="divStatus"></a><a id="4445" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#4445" class="Function">divStatus</a> <a id="4455" class="Symbol">:</a> <a id="4457" class="Symbol">(</a><a id="4458" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#4458" class="Bound">a</a> <a id="4460" class="Symbol">:</a> <a id="4462" href="Cubical.Data.Int.Base.html#393" class="Datatype">ℤ</a><a id="4463" class="Symbol">)(</a><a id="4465" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#4465" class="Bound">M</a> <a id="4467" class="Symbol">:</a> <a id="4469" href="Cubical.Algebra.Matrix.CommRingCoefficient.html#999" class="Function">Mat</a> <a id="4473" class="Symbol">(</a><a id="4474" class="InductiveConstructor">suc</a> <a id="4478" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#1700" class="Generalizable">m</a><a id="4479" class="Symbol">)</a> <a id="4481" class="Symbol">(</a><a id="4482" class="InductiveConstructor">suc</a> <a id="4486" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#1702" class="Generalizable">n</a><a id="4487" class="Symbol">))</a> <a id="4490" class="Symbol">→</a> <a id="4492" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#4146" class="Datatype">DivStatus</a> <a id="4502" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#4458" class="Bound">a</a> <a id="4504" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#4465" class="Bound">M</a>
<a id="4506" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#4445" class="Function">divStatus</a> <a id="4516" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#4516" class="Bound">a</a> <a id="4518" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#4518" class="Bound">M</a> <a id="4520" class="Symbol">=</a>
  <a id="4524" class="Keyword">let</a>  <a id="4529" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#4529" class="Bound">col?</a> <a id="4534" class="Symbol">=</a> <a id="4536" href="Cubical.Data.FinData.Properties.html#9280" class="Function">∀Dec</a> <a id="4541" class="Symbol">(λ</a> <a id="4544" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#4544" class="Bound">i</a> <a id="4546" class="Symbol">→</a> <a id="4548" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#4516" class="Bound">a</a> <a id="4550" href="Cubical.Data.Int.Divisibility.html#1792" class="Function Operator">∣</a> <a id="4552" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#4518" class="Bound">M</a> <a id="4554" class="Symbol">(</a><a id="4555" href="Cubical.Data.FinData.Base.html#430" class="InductiveConstructor">suc</a> <a id="4559" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#4544" class="Bound">i</a><a id="4560" class="Symbol">)</a> <a id="4562" href="Cubical.Data.FinData.Base.html#399" class="InductiveConstructor">zero</a><a id="4566" class="Symbol">)</a> <a id="4568" class="Symbol">(λ</a> <a id="4571" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#4571" class="Bound">_</a> <a id="4573" class="Symbol">→</a> <a id="4575" href="Cubical.Data.Int.Divisibility.html#14069" class="Function">dec∣</a> <a id="4580" class="Symbol">_</a> <a id="4582" class="Symbol">_)</a>
       <a id="4592" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#4592" class="Bound">row?</a> <a id="4597" class="Symbol">=</a> <a id="4599" href="Cubical.Data.FinData.Properties.html#9280" class="Function">∀Dec</a> <a id="4604" class="Symbol">(λ</a> <a id="4607" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#4607" class="Bound">j</a> <a id="4609" class="Symbol">→</a> <a id="4611" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#4516" class="Bound">a</a> <a id="4613" href="Cubical.Data.Int.Divisibility.html#1792" class="Function Operator">∣</a> <a id="4615" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#4518" class="Bound">M</a> <a id="4617" href="Cubical.Data.FinData.Base.html#399" class="InductiveConstructor">zero</a> <a id="4622" class="Symbol">(</a><a id="4623" href="Cubical.Data.FinData.Base.html#430" class="InductiveConstructor">suc</a> <a id="4627" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#4607" class="Bound">j</a><a id="4628" class="Symbol">))</a> <a id="4631" class="Symbol">(λ</a> <a id="4634" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#4634" class="Bound">_</a> <a id="4636" class="Symbol">→</a> <a id="4638" href="Cubical.Data.Int.Divisibility.html#14069" class="Function">dec∣</a> <a id="4643" class="Symbol">_</a> <a id="4645" class="Symbol">_)</a> <a id="4648" class="Keyword">in</a>
  <a id="4653" href="Cubical.Foundations.Function.html#1341" class="Function Operator">case</a> <a id="4658" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#4529" class="Bound">col?</a>
  <a id="4665" href="Cubical.Foundations.Function.html#1341" class="Function Operator">return</a> <a id="4672" class="Symbol">(λ</a> <a id="4675" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#4675" class="Bound">_</a> <a id="4677" class="Symbol">→</a> <a id="4679" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#4146" class="Datatype">DivStatus</a> <a id="4689" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#4516" class="Bound">a</a> <a id="4691" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#4518" class="Bound">M</a><a id="4692" class="Symbol">)</a> <a id="4694" href="Cubical.Foundations.Function.html#1341" class="Function Operator">of</a> <a id="4697" class="Symbol">λ</a>
  <a id="4701" class="Symbol">{</a> <a id="4703" class="Symbol">(</a><a id="4704" href="Cubical.Data.Sum.Base.html#279" class="InductiveConstructor">inr</a> <a id="4708" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#4708" class="Bound">p</a><a id="4709" class="Symbol">)</a> <a id="4711" class="Symbol">→</a> <a id="4713" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#4204" class="InductiveConstructor">badCol</a> <a id="4720" class="Symbol">(</a><a id="4721" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#4708" class="Bound">p</a> <a id="4723" class="Symbol">.</a><a id="4724" href="Agda.Builtin.Sigma.html#252" class="Field">fst</a><a id="4727" class="Symbol">)</a> <a id="4729" class="Symbol">(</a><a id="4730" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#4708" class="Bound">p</a> <a id="4732" class="Symbol">.</a><a id="4733" href="Agda.Builtin.Sigma.html#264" class="Field">snd</a><a id="4736" class="Symbol">)</a>
  <a id="4740" class="Symbol">;</a> <a id="4742" class="Symbol">(</a><a id="4743" href="Cubical.Data.Sum.Base.html#261" class="InductiveConstructor">inl</a> <a id="4747" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#4747" class="Bound">p</a><a id="4748" class="Symbol">)</a> <a id="4750" class="Symbol">→</a>
      <a id="4758" href="Cubical.Foundations.Function.html#1341" class="Function Operator">case</a> <a id="4763" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#4592" class="Bound">row?</a>
      <a id="4774" href="Cubical.Foundations.Function.html#1341" class="Function Operator">return</a> <a id="4781" class="Symbol">(λ</a> <a id="4784" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#4784" class="Bound">_</a> <a id="4786" class="Symbol">→</a> <a id="4788" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#4146" class="Datatype">DivStatus</a> <a id="4798" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#4516" class="Bound">a</a> <a id="4800" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#4518" class="Bound">M</a><a id="4801" class="Symbol">)</a> <a id="4803" href="Cubical.Foundations.Function.html#1341" class="Function Operator">of</a> <a id="4806" class="Symbol">λ</a>
      <a id="4814" class="Symbol">{</a> <a id="4816" class="Symbol">(</a><a id="4817" href="Cubical.Data.Sum.Base.html#279" class="InductiveConstructor">inr</a> <a id="4821" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#4821" class="Bound">q</a><a id="4822" class="Symbol">)</a> <a id="4824" class="Symbol">→</a> <a id="4826" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#4270" class="InductiveConstructor">badRow</a> <a id="4833" class="Symbol">(</a><a id="4834" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#4821" class="Bound">q</a> <a id="4836" class="Symbol">.</a><a id="4837" href="Agda.Builtin.Sigma.html#252" class="Field">fst</a><a id="4840" class="Symbol">)</a> <a id="4842" class="Symbol">(</a><a id="4843" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#4821" class="Bound">q</a> <a id="4845" class="Symbol">.</a><a id="4846" href="Agda.Builtin.Sigma.html#264" class="Field">snd</a><a id="4849" class="Symbol">)</a>
      <a id="4857" class="Symbol">;</a> <a id="4859" class="Symbol">(</a><a id="4860" href="Cubical.Data.Sum.Base.html#261" class="InductiveConstructor">inl</a> <a id="4864" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#4864" class="Bound">q</a><a id="4865" class="Symbol">)</a> <a id="4867" class="Symbol">→</a> <a id="4869" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#4336" class="InductiveConstructor">allDone</a> <a id="4877" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#4747" class="Bound">p</a> <a id="4879" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#4864" class="Bound">q</a> <a id="4881" class="Symbol">}}</a>

<a id="4885" class="Keyword">record</a> <a id="DiagStep"></a><a id="4892" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#4892" class="Record">DiagStep</a> <a id="4901" class="Symbol">(</a><a id="4902" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#4902" class="Bound">M</a> <a id="4904" class="Symbol">:</a> <a id="4906" href="Cubical.Algebra.Matrix.CommRingCoefficient.html#999" class="Function">Mat</a> <a id="4910" class="Symbol">(</a><a id="4911" href="Agda.Builtin.Nat.html#223" class="InductiveConstructor">suc</a> <a id="4915" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#1700" class="Generalizable">m</a><a id="4916" class="Symbol">)</a> <a id="4918" class="Symbol">(</a><a id="4919" href="Agda.Builtin.Nat.html#223" class="InductiveConstructor">suc</a> <a id="4923" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#1702" class="Generalizable">n</a><a id="4924" class="Symbol">))</a> <a id="4927" class="Symbol">:</a> <a id="4929" href="Agda.Primitive.html#326" class="Primitive">Type</a> <a id="4934" class="Keyword">where</a>
  <a id="4942" class="Keyword">field</a>
    <a id="DiagStep.sim"></a><a id="4952" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#4952" class="Field">sim</a> <a id="4956" class="Symbol">:</a> <a id="4958" href="Cubical.Algebra.Matrix.CommRingCoefficient.html#6605" class="Record">Sim</a> <a id="4962" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#4902" class="Bound">M</a>

    <a id="DiagStep.firstColClean"></a><a id="4969" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#4969" class="Field">firstColClean</a> <a id="4983" class="Symbol">:</a> <a id="4985" class="Symbol">(</a><a id="4986" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#4986" class="Bound">i</a> <a id="4988" class="Symbol">:</a> <a id="4990" href="Cubical.Data.FinData.Base.html#375" class="Datatype">Fin</a> <a id="4994" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#4915" class="Bound">m</a><a id="4995" class="Symbol">)</a> <a id="4997" class="Symbol">→</a> <a id="4999" class="Field">sim</a> <a id="5003" class="Symbol">.</a><a id="5004" href="Cubical.Algebra.Matrix.CommRingCoefficient.html#6654" class="Field">result</a> <a id="5011" class="Symbol">(</a><a id="5012" href="Cubical.Data.FinData.Base.html#430" class="InductiveConstructor">suc</a> <a id="5016" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#4986" class="Bound">i</a><a id="5017" class="Symbol">)</a> <a id="5019" href="Cubical.Data.FinData.Base.html#399" class="InductiveConstructor">zero</a> <a id="5024" href="Agda.Builtin.Cubical.Path.html#381" class="Function Operator">≡</a> <a id="5026" class="Number">0</a>
    <a id="DiagStep.firstRowClean"></a><a id="5032" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#5032" class="Field">firstRowClean</a> <a id="5046" class="Symbol">:</a> <a id="5048" class="Symbol">(</a><a id="5049" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#5049" class="Bound">j</a> <a id="5051" class="Symbol">:</a> <a id="5053" href="Cubical.Data.FinData.Base.html#375" class="Datatype">Fin</a> <a id="5057" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#4923" class="Bound">n</a><a id="5058" class="Symbol">)</a> <a id="5060" class="Symbol">→</a> <a id="5062" class="Field">sim</a> <a id="5066" class="Symbol">.</a><a id="5067" href="Cubical.Algebra.Matrix.CommRingCoefficient.html#6654" class="Field">result</a> <a id="5074" href="Cubical.Data.FinData.Base.html#399" class="InductiveConstructor">zero</a> <a id="5079" class="Symbol">(</a><a id="5080" href="Cubical.Data.FinData.Base.html#430" class="InductiveConstructor">suc</a> <a id="5084" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#5049" class="Bound">j</a><a id="5085" class="Symbol">)</a> <a id="5087" href="Agda.Builtin.Cubical.Path.html#381" class="Function Operator">≡</a> <a id="5089" class="Number">0</a>

    <a id="DiagStep.nonZero"></a><a id="5096" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#5096" class="Field">nonZero</a> <a id="5104" class="Symbol">:</a> <a id="5106" href="Cubical.Relation.Nullary.Base.html#355" class="Function Operator">¬</a> <a id="5108" class="Field">sim</a> <a id="5112" class="Symbol">.</a><a id="5113" href="Cubical.Algebra.Matrix.CommRingCoefficient.html#6654" class="Field">result</a> <a id="5120" href="Cubical.Data.FinData.Base.html#399" class="InductiveConstructor">zero</a> <a id="5125" href="Cubical.Data.FinData.Base.html#399" class="InductiveConstructor">zero</a> <a id="5130" href="Agda.Builtin.Cubical.Path.html#381" class="Function Operator">≡</a> <a id="5132" class="Number">0</a>

<a id="5135" class="Keyword">open</a> <a id="5140" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#4892" class="Module">DiagStep</a>

<a id="simDiagStep"></a><a id="5150" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#5150" class="Function">simDiagStep</a> <a id="5162" class="Symbol">:</a> <a id="5164" class="Symbol">{</a><a id="5165" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#5165" class="Bound">M</a> <a id="5167" class="Symbol">:</a> <a id="5169" href="Cubical.Algebra.Matrix.CommRingCoefficient.html#999" class="Function">Mat</a> <a id="5173" class="Symbol">(</a><a id="5174" class="InductiveConstructor">suc</a> <a id="5178" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#1700" class="Generalizable">m</a><a id="5179" class="Symbol">)</a> <a id="5181" class="Symbol">(</a><a id="5182" class="InductiveConstructor">suc</a> <a id="5186" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#1702" class="Generalizable">n</a><a id="5187" class="Symbol">)}(</a><a id="5190" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#5190" class="Bound">sim</a> <a id="5194" class="Symbol">:</a> <a id="5196" href="Cubical.Algebra.Matrix.CommRingCoefficient.html#6605" class="Record">Sim</a> <a id="5200" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#5165" class="Bound">M</a><a id="5201" class="Symbol">)</a> <a id="5203" class="Symbol">→</a> <a id="5205" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#4892" class="Record">DiagStep</a> <a id="5214" class="Symbol">(</a><a id="5215" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#5190" class="Bound">sim</a> <a id="5219" class="Symbol">.</a><a id="5220" href="Cubical.Algebra.Matrix.CommRingCoefficient.html#6654" class="Field">result</a><a id="5226" class="Symbol">)</a> <a id="5228" class="Symbol">→</a> <a id="5230" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#4892" class="Record">DiagStep</a> <a id="5239" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#5165" class="Bound">M</a>
<a id="5241" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#5150" class="Function">simDiagStep</a> <a id="5253" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#5253" class="Bound">simM</a> <a id="5258" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#5258" class="Bound">diag</a> <a id="5263" class="Symbol">.</a><a id="5264" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#4952" class="Field">sim</a> <a id="5268" class="Symbol">=</a> <a id="5270" href="Cubical.Algebra.Matrix.CommRingCoefficient.html#8222" class="Function">compSim</a> <a id="5278" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#5253" class="Bound">simM</a> <a id="5283" class="Symbol">(</a><a id="5284" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#5258" class="Bound">diag</a> <a id="5289" class="Symbol">.</a><a id="5290" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#4952" class="Field">sim</a><a id="5293" class="Symbol">)</a>
<a id="5295" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#5150" class="Function">simDiagStep</a> <a id="5307" class="Symbol">_</a>    <a id="5312" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#5312" class="Bound">diag</a> <a id="5317" class="Symbol">.</a><a id="5318" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#4969" class="Field">firstColClean</a> <a id="5332" class="Symbol">=</a> <a id="5334" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#5312" class="Bound">diag</a> <a id="5339" class="Symbol">.</a><a id="5340" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#4969" class="Field">firstColClean</a>
<a id="5354" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#5150" class="Function">simDiagStep</a> <a id="5366" class="Symbol">_</a>    <a id="5371" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#5371" class="Bound">diag</a> <a id="5376" class="Symbol">.</a><a id="5377" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#5032" class="Field">firstRowClean</a> <a id="5391" class="Symbol">=</a> <a id="5393" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#5371" class="Bound">diag</a> <a id="5398" class="Symbol">.</a><a id="5399" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#5032" class="Field">firstRowClean</a>
<a id="5413" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#5150" class="Function">simDiagStep</a> <a id="5425" class="Symbol">_</a>    <a id="5430" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#5430" class="Bound">diag</a> <a id="5435" class="Symbol">.</a><a id="5436" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#5096" class="Field">nonZero</a> <a id="5444" class="Symbol">=</a> <a id="5446" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#5430" class="Bound">diag</a> <a id="5451" class="Symbol">.</a><a id="5452" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#5096" class="Field">nonZero</a>

<a id="5461" class="Keyword">private</a>
  <a id="diagStep-helper"></a><a id="5471" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#5471" class="Function">diagStep-helper</a> <a id="5487" class="Symbol">:</a>
      <a id="5495" class="Symbol">(</a><a id="5496" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#5496" class="Bound">M</a> <a id="5498" class="Symbol">:</a> <a id="5500" href="Cubical.Algebra.Matrix.CommRingCoefficient.html#999" class="Function">Mat</a> <a id="5504" class="Symbol">(</a><a id="5505" class="InductiveConstructor">suc</a> <a id="5509" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#1700" class="Generalizable">m</a><a id="5510" class="Symbol">)</a> <a id="5512" class="Symbol">(</a><a id="5513" class="InductiveConstructor">suc</a> <a id="5517" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#1702" class="Generalizable">n</a><a id="5518" class="Symbol">))</a>
    <a id="5525" class="Symbol">→</a> <a id="5527" class="Symbol">(</a><a id="5528" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#5528" class="Bound">p</a> <a id="5530" class="Symbol">:</a> <a id="5532" href="Cubical.Relation.Nullary.Base.html#355" class="Function Operator">¬</a> <a id="5534" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#5496" class="Bound">M</a> <a id="5536" class="InductiveConstructor">zero</a> <a id="5541" class="InductiveConstructor">zero</a> <a id="5546" href="Agda.Builtin.Cubical.Path.html#381" class="Function Operator">≡</a> <a id="5548" class="Number">0</a><a id="5549" class="Symbol">)(</a><a id="5551" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#5551" class="Bound">h</a> <a id="5553" class="Symbol">:</a> <a id="5555" href="Cubical.Algebra.IntegerMatrix.Base.html#1260" class="Function">Norm</a> <a id="5560" class="Symbol">(</a><a id="5561" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#5496" class="Bound">M</a> <a id="5563" class="InductiveConstructor">zero</a> <a id="5568" class="InductiveConstructor">zero</a><a id="5572" class="Symbol">))</a>
    <a id="5579" class="Symbol">→</a> <a id="5581" class="Symbol">(</a><a id="5582" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#5582" class="Bound">div?</a> <a id="5587" class="Symbol">:</a> <a id="5589" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#4146" class="Datatype">DivStatus</a> <a id="5599" class="Symbol">(</a><a id="5600" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#5496" class="Bound">M</a> <a id="5602" class="InductiveConstructor">zero</a> <a id="5607" class="InductiveConstructor">zero</a><a id="5611" class="Symbol">)</a> <a id="5613" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#5496" class="Bound">M</a><a id="5614" class="Symbol">)</a>
    <a id="5620" class="Symbol">→</a> <a id="5622" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#4892" class="Record">DiagStep</a> <a id="5631" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#5496" class="Bound">M</a>
  <a id="5635" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#5471" class="Function">diagStep-helper</a> <a id="5651" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#5651" class="Bound">M</a> <a id="5653" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#5653" class="Bound">p</a> <a id="5655" class="Symbol">(</a><a id="5656" href="Cubical.Induction.WellFounded.html#363" class="InductiveConstructor">acc</a> <a id="5660" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#5660" class="Bound">ind</a><a id="5663" class="Symbol">)</a> <a id="5665" class="Symbol">(</a><a id="5666" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#4204" class="InductiveConstructor">badCol</a> <a id="5673" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#5673" class="Bound">i</a> <a id="5675" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#5675" class="Bound">q</a><a id="5676" class="Symbol">)</a> <a id="5678" class="Symbol">=</a>
    <a id="5684" class="Keyword">let</a> <a id="5688" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#5688" class="Bound">improved</a> <a id="5697" class="Symbol">=</a> <a id="5699" href="Cubical.Algebra.IntegerMatrix.Elementaries.html#8279" class="Function">improveRows</a> <a id="5711" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#5651" class="Bound">M</a> <a id="5713" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#5653" class="Bound">p</a>
        <a id="5723" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#5723" class="Bound">normIneq</a> <a id="5732" class="Symbol">=</a>
          <a id="5744" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#5660" class="Bound">ind</a> <a id="5748" class="Symbol">_</a> <a id="5750" class="Symbol">(</a><a id="5751" href="Cubical.Data.Int.Divisibility.html#5049" class="Function">stDivIneq</a> <a id="5761" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#5653" class="Bound">p</a> <a id="5763" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#5675" class="Bound">q</a> <a id="5765" class="Symbol">(</a><a id="5766" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#5688" class="Bound">improved</a> <a id="5775" class="Symbol">.</a><a id="5776" href="Cubical.Algebra.IntegerMatrix.Elementaries.html#7806" class="Field">div</a> <a id="5780" href="Cubical.Data.FinData.Base.html#399" class="InductiveConstructor">zero</a><a id="5784" class="Symbol">)</a> <a id="5786" class="Symbol">(</a><a id="5787" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#5688" class="Bound">improved</a> <a id="5796" class="Symbol">.</a><a id="5797" href="Cubical.Algebra.IntegerMatrix.Elementaries.html#7806" class="Field">div</a> <a id="5801" class="Symbol">(</a><a id="5802" href="Cubical.Data.FinData.Base.html#430" class="InductiveConstructor">suc</a> <a id="5806" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#5673" class="Bound">i</a><a id="5807" class="Symbol">)))</a>
    <a id="5815" class="Keyword">in</a>  <a id="5819" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#5150" class="Function">simDiagStep</a> <a id="5831" class="Symbol">(</a><a id="5832" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#5688" class="Bound">improved</a> <a id="5841" class="Symbol">.</a><a id="5842" href="Cubical.Algebra.IntegerMatrix.Elementaries.html#7787" class="Field">sim</a><a id="5845" class="Symbol">)</a>
                    <a id="5867" class="Symbol">(</a><a id="5868" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#5471" class="Function">diagStep-helper</a> <a id="5884" class="Symbol">_</a> <a id="5886" class="Symbol">(</a><a id="5887" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#5688" class="Bound">improved</a> <a id="5896" class="Symbol">.</a><a id="5897" href="Cubical.Algebra.IntegerMatrix.Elementaries.html#7934" class="Field">nonZero</a><a id="5904" class="Symbol">)</a> <a id="5906" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#5723" class="Bound">normIneq</a> <a id="5915" class="Symbol">(</a><a id="5916" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#4445" class="Function">divStatus</a> <a id="5926" class="Symbol">_</a> <a id="5928" class="Symbol">_))</a>
  <a id="5934" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#5471" class="Function">diagStep-helper</a> <a id="5950" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#5950" class="Bound">M</a> <a id="5952" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#5952" class="Bound">p</a> <a id="5954" class="Symbol">(</a><a id="5955" href="Cubical.Induction.WellFounded.html#363" class="InductiveConstructor">acc</a> <a id="5959" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#5959" class="Bound">ind</a><a id="5962" class="Symbol">)</a> <a id="5964" class="Symbol">(</a><a id="5965" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#4270" class="InductiveConstructor">badRow</a> <a id="5972" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#5972" class="Bound">j</a> <a id="5974" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#5974" class="Bound">q</a><a id="5975" class="Symbol">)</a> <a id="5977" class="Symbol">=</a>
    <a id="5983" class="Keyword">let</a> <a id="5987" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#5987" class="Bound">improved</a> <a id="5996" class="Symbol">=</a> <a id="5998" href="Cubical.Algebra.IntegerMatrix.Elementaries.html#8894" class="Function">improveCols</a> <a id="6010" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#5950" class="Bound">M</a> <a id="6012" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#5952" class="Bound">p</a>
        <a id="6022" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#6022" class="Bound">normIneq</a> <a id="6031" class="Symbol">=</a>
          <a id="6043" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#5959" class="Bound">ind</a> <a id="6047" class="Symbol">_</a> <a id="6049" class="Symbol">(</a><a id="6050" href="Cubical.Data.Int.Divisibility.html#5049" class="Function">stDivIneq</a> <a id="6060" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#5952" class="Bound">p</a> <a id="6062" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#5974" class="Bound">q</a> <a id="6064" class="Symbol">(</a><a id="6065" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#5987" class="Bound">improved</a> <a id="6074" class="Symbol">.</a><a id="6075" href="Cubical.Algebra.IntegerMatrix.Elementaries.html#8069" class="Field">div</a> <a id="6079" href="Cubical.Data.FinData.Base.html#399" class="InductiveConstructor">zero</a><a id="6083" class="Symbol">)</a> <a id="6085" class="Symbol">(</a><a id="6086" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#5987" class="Bound">improved</a> <a id="6095" class="Symbol">.</a><a id="6096" href="Cubical.Algebra.IntegerMatrix.Elementaries.html#8069" class="Field">div</a> <a id="6100" class="Symbol">(</a><a id="6101" href="Cubical.Data.FinData.Base.html#430" class="InductiveConstructor">suc</a> <a id="6105" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#5972" class="Bound">j</a><a id="6106" class="Symbol">)))</a>
    <a id="6114" class="Keyword">in</a>  <a id="6118" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#5150" class="Function">simDiagStep</a> <a id="6130" class="Symbol">(</a><a id="6131" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#5987" class="Bound">improved</a> <a id="6140" class="Symbol">.</a><a id="6141" href="Cubical.Algebra.IntegerMatrix.Elementaries.html#8050" class="Field">sim</a><a id="6144" class="Symbol">)</a>
                    <a id="6166" class="Symbol">(</a><a id="6167" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#5471" class="Function">diagStep-helper</a> <a id="6183" class="Symbol">_</a> <a id="6185" class="Symbol">(</a><a id="6186" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#5987" class="Bound">improved</a> <a id="6195" class="Symbol">.</a><a id="6196" href="Cubical.Algebra.IntegerMatrix.Elementaries.html#8197" class="Field">nonZero</a><a id="6203" class="Symbol">)</a> <a id="6205" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#6022" class="Bound">normIneq</a> <a id="6214" class="Symbol">(</a><a id="6215" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#4445" class="Function">divStatus</a> <a id="6225" class="Symbol">_</a> <a id="6227" class="Symbol">_))</a>
  <a id="6233" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#5471" class="Function">diagStep-helper</a> <a id="6249" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#6249" class="Bound">M</a> <a id="6251" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#6251" class="Bound">p</a> <a id="6253" class="Symbol">(</a><a id="6254" href="Cubical.Induction.WellFounded.html#363" class="InductiveConstructor">acc</a> <a id="6258" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#6258" class="Bound">ind</a><a id="6261" class="Symbol">)</a> <a id="6263" class="Symbol">(</a><a id="6264" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#4336" class="InductiveConstructor">allDone</a> <a id="6272" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#6272" class="Bound">div₁</a> <a id="6277" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#6277" class="Bound">div₂</a><a id="6281" class="Symbol">)</a> <a id="6283" class="Symbol">=</a>
    <a id="6289" class="Keyword">let</a> <a id="6293" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#6293" class="Bound">improveColM</a> <a id="6305" class="Symbol">=</a> <a id="6307" href="Cubical.Algebra.IntegerMatrix.Elementaries.html#8894" class="Function">improveCols</a> <a id="6319" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#6249" class="Bound">M</a> <a id="6321" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#6251" class="Bound">p</a>
        <a id="6331" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#6331" class="Bound">invCol</a> <a id="6338" class="Symbol">=</a> <a id="6340" href="Cubical.Algebra.IntegerMatrix.Elementaries.html#5060" class="Function">bézoutRows-inv</a> <a id="6355" class="Symbol">_</a> <a id="6357" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#6251" class="Bound">p</a> <a id="6359" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#6277" class="Bound">div₂</a>
        <a id="6372" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#6372" class="Bound">divCol</a> <a id="6379" class="Symbol">=</a> <a id="6381" class="Symbol">(λ</a> <a id="6384" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#6384" class="Bound">i</a> <a id="6386" class="Symbol">→</a> <a id="6388" href="Cubical.Foundations.Prelude.html#7995" class="Function">transport</a> <a id="6398" class="Symbol">(λ</a> <a id="6401" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#6401" class="Bound">t</a> <a id="6403" class="Symbol">→</a> <a id="6405" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#6331" class="Bound">invCol</a> <a id="6412" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#6401" class="Bound">t</a> <a id="6414" href="Cubical.Data.FinData.Base.html#399" class="InductiveConstructor">zero</a> <a id="6419" href="Cubical.Data.Int.Divisibility.html#1792" class="Function Operator">∣</a> <a id="6421" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#6331" class="Bound">invCol</a> <a id="6428" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#6401" class="Bound">t</a> <a id="6430" class="Symbol">(</a><a id="6431" href="Cubical.Data.FinData.Base.html#430" class="InductiveConstructor">suc</a> <a id="6435" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#6384" class="Bound">i</a><a id="6436" class="Symbol">))</a> <a id="6439" class="Symbol">(</a><a id="6440" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#6272" class="Bound">div₁</a> <a id="6445" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#6384" class="Bound">i</a><a id="6446" class="Symbol">))</a>
        <a id="6457" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#6457" class="Bound">improveRowM</a> <a id="6469" class="Symbol">=</a> <a id="6471" href="Cubical.Algebra.IntegerMatrix.Elementaries.html#8279" class="Function">improveRows</a> <a id="6483" class="Symbol">(</a><a id="6484" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#6293" class="Bound">improveColM</a> <a id="6496" class="Symbol">.</a><a id="6497" href="Cubical.Algebra.IntegerMatrix.Elementaries.html#8050" class="Field">sim</a> <a id="6501" class="Symbol">.</a><a id="6502" href="Cubical.Algebra.Matrix.CommRingCoefficient.html#6654" class="Field">result</a><a id="6508" class="Symbol">)</a> <a id="6510" class="Symbol">(</a><a id="6511" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#6293" class="Bound">improveColM</a> <a id="6523" class="Symbol">.</a><a id="6524" href="Cubical.Algebra.IntegerMatrix.Elementaries.html#8197" class="Field">nonZero</a><a id="6531" class="Symbol">)</a>
        <a id="6541" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#6541" class="Bound">invCol</a> <a id="6548" class="Symbol">=</a> <a id="6550" href="Cubical.Algebra.IntegerMatrix.Elementaries.html#5060" class="Function">bézoutRows-inv</a> <a id="6565" class="Symbol">_</a> <a id="6567" class="Symbol">(</a><a id="6568" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#6293" class="Bound">improveColM</a> <a id="6580" class="Symbol">.</a><a id="6581" href="Cubical.Algebra.IntegerMatrix.Elementaries.html#8197" class="Field">nonZero</a><a id="6588" class="Symbol">)</a> <a id="6590" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#6372" class="Bound">divCol</a>
    <a id="6601" class="Keyword">in</a>  <a id="6605" class="Keyword">record</a>
        <a id="6620" class="Symbol">{</a> <a id="6622" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#4952" class="Field">sim</a> <a id="6626" class="Symbol">=</a> <a id="6628" href="Cubical.Algebra.Matrix.CommRingCoefficient.html#8222" class="Function">compSim</a> <a id="6636" class="Symbol">(</a><a id="6637" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#6293" class="Bound">improveColM</a> <a id="6649" class="Symbol">.</a><a id="6650" href="Cubical.Algebra.IntegerMatrix.Elementaries.html#8050" class="Field">sim</a><a id="6653" class="Symbol">)</a> <a id="6655" class="Symbol">(</a><a id="6656" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#6457" class="Bound">improveRowM</a> <a id="6668" class="Symbol">.</a><a id="6669" href="Cubical.Algebra.IntegerMatrix.Elementaries.html#7787" class="Field">sim</a><a id="6672" class="Symbol">)</a>
        <a id="6682" class="Symbol">;</a> <a id="6684" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#4969" class="Field">firstColClean</a> <a id="6698" class="Symbol">=</a> <a id="6700" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#6457" class="Bound">improveRowM</a> <a id="6712" class="Symbol">.</a><a id="6713" href="Cubical.Algebra.IntegerMatrix.Elementaries.html#7875" class="Field">vanish</a>
        <a id="6728" class="Symbol">;</a> <a id="6730" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#5032" class="Field">firstRowClean</a> <a id="6744" class="Symbol">=</a> <a id="6746" class="Symbol">(λ</a> <a id="6749" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#6749" class="Bound">j</a> <a id="6751" class="Symbol">→</a> <a id="6753" class="Symbol">(λ</a> <a id="6756" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#6756" class="Bound">t</a> <a id="6758" class="Symbol">→</a> <a id="6760" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#6541" class="Bound">invCol</a> <a id="6767" class="Symbol">(</a><a id="6768" href="Cubical.Core.Primitives.html#539" class="Primitive Operator">~</a> <a id="6770" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#6756" class="Bound">t</a><a id="6771" class="Symbol">)</a> <a id="6773" class="Symbol">(</a><a id="6774" href="Cubical.Data.FinData.Base.html#430" class="InductiveConstructor">suc</a> <a id="6778" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#6749" class="Bound">j</a><a id="6779" class="Symbol">))</a> <a id="6782" href="Cubical.Foundations.Prelude.html#3894" class="Function Operator">∙</a> <a id="6784" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#6293" class="Bound">improveColM</a> <a id="6796" class="Symbol">.</a><a id="6797" href="Cubical.Algebra.IntegerMatrix.Elementaries.html#8138" class="Field">vanish</a> <a id="6804" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#6749" class="Bound">j</a><a id="6805" class="Symbol">)</a>
        <a id="6815" class="Symbol">;</a> <a id="6817" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#5096" class="Field">nonZero</a> <a id="6825" class="Symbol">=</a> <a id="6827" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#6457" class="Bound">improveRowM</a> <a id="6839" class="Symbol">.</a><a id="6840" href="Cubical.Algebra.IntegerMatrix.Elementaries.html#7934" class="Field">nonZero</a> <a id="6848" class="Symbol">}</a>

  <a id="diagStep-getStart"></a><a id="6853" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#6853" class="Function">diagStep-getStart</a> <a id="6871" class="Symbol">:</a> <a id="6873" class="Symbol">(</a><a id="6874" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#6874" class="Bound">M</a> <a id="6876" class="Symbol">:</a> <a id="6878" href="Cubical.Algebra.Matrix.CommRingCoefficient.html#999" class="Function">Mat</a> <a id="6882" class="Symbol">(</a><a id="6883" class="InductiveConstructor">suc</a> <a id="6887" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#1700" class="Generalizable">m</a><a id="6888" class="Symbol">)</a> <a id="6890" class="Symbol">(</a><a id="6891" class="InductiveConstructor">suc</a> <a id="6895" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#1702" class="Generalizable">n</a><a id="6896" class="Symbol">))</a> <a id="6899" class="Symbol">→</a> <a id="6901" href="Cubical.Algebra.IntegerMatrix.Base.html#2866" class="Datatype">NonZeroOrNot</a> <a id="6914" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#6874" class="Bound">M</a> <a id="6916" class="Symbol">→</a> <a id="6918" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#4892" class="Record">DiagStep</a> <a id="6927" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#6874" class="Bound">M</a> <a id="6929" href="Cubical.Data.Sum.Base.html#203" class="Datatype Operator">⊎</a> <a id="6931" class="Symbol">(</a><a id="6932" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#6874" class="Bound">M</a> <a id="6934" href="Agda.Builtin.Cubical.Path.html#381" class="Function Operator">≡</a> <a id="6936" href="Cubical.Algebra.Matrix.CommRingCoefficient.html#1482" class="Function">𝟘</a><a id="6937" class="Symbol">)</a>
  <a id="6941" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#6853" class="Function">diagStep-getStart</a> <a id="6959" class="Symbol">_</a> <a id="6961" class="Symbol">(</a><a id="6962" href="Cubical.Algebra.IntegerMatrix.Base.html#3001" class="InductiveConstructor">allZero</a> <a id="6970" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#6970" class="Bound">p</a><a id="6971" class="Symbol">)</a> <a id="6973" class="Symbol">=</a> <a id="6975" href="Cubical.Data.Sum.Base.html#279" class="InductiveConstructor">inr</a> <a id="6979" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#6970" class="Bound">p</a>
  <a id="6983" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#6853" class="Function">diagStep-getStart</a> <a id="7001" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#7001" class="Bound">M</a> <a id="7003" class="Symbol">(</a><a id="7004" href="Cubical.Algebra.IntegerMatrix.Base.html#2920" class="InductiveConstructor">hereIs</a> <a id="7011" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#7011" class="Bound">i</a> <a id="7013" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#7013" class="Bound">j</a> <a id="7015" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#7015" class="Bound">p</a><a id="7016" class="Symbol">)</a> <a id="7018" class="Symbol">=</a>
    <a id="7024" class="Keyword">let</a> <a id="7028" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#7028" class="Bound">swapM</a> <a id="7034" class="Symbol">=</a> <a id="7036" href="Cubical.Algebra.Matrix.Elementaries.html#6830" class="Function">swapPivot</a> <a id="7046" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#7011" class="Bound">i</a> <a id="7048" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#7013" class="Bound">j</a> <a id="7050" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#7001" class="Bound">M</a>
        <a id="7060" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#7060" class="Bound">swapNonZero</a> <a id="7072" class="Symbol">=</a> <a id="7074" class="Symbol">(λ</a> <a id="7077" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#7077" class="Bound">r</a> <a id="7079" class="Symbol">→</a> <a id="7081" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#7015" class="Bound">p</a> <a id="7083" class="Symbol">(</a><a id="7084" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#7028" class="Bound">swapM</a> <a id="7090" class="Symbol">.</a><a id="7091" href="Cubical.Algebra.Matrix.Elementaries.html#5530" class="Field">swapEq</a> <a id="7098" href="Cubical.Foundations.Prelude.html#3894" class="Function Operator">∙</a> <a id="7100" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#7077" class="Bound">r</a><a id="7101" class="Symbol">))</a>
        <a id="7112" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#7112" class="Bound">diagM</a> <a id="7118" class="Symbol">=</a> <a id="7120" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#5471" class="Function">diagStep-helper</a> <a id="7136" class="Symbol">_</a> <a id="7138" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#7060" class="Bound">swapNonZero</a> <a id="7150" class="Symbol">(</a><a id="7151" href="Cubical.Data.Nat.Order.html#7707" class="Function">&lt;-wellfounded</a> <a id="7165" class="Symbol">_)</a> <a id="7168" class="Symbol">(</a><a id="7169" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#4445" class="Function">divStatus</a> <a id="7179" class="Symbol">_</a> <a id="7181" class="Symbol">_)</a>
    <a id="7188" class="Keyword">in</a>  <a id="7192" href="Cubical.Data.Sum.Base.html#261" class="InductiveConstructor">inl</a> <a id="7196" class="Symbol">(</a><a id="7197" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#5150" class="Function">simDiagStep</a> <a id="7209" class="Symbol">(</a><a id="7210" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#7028" class="Bound">swapM</a> <a id="7216" class="Symbol">.</a><a id="7217" href="Cubical.Algebra.Matrix.Elementaries.html#5512" class="Field">sim</a><a id="7220" class="Symbol">)</a> <a id="7222" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#7112" class="Bound">diagM</a><a id="7227" class="Symbol">)</a>

<a id="diagStep"></a><a id="7230" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#7230" class="Function">diagStep</a> <a id="7239" class="Symbol">:</a> <a id="7241" class="Symbol">(</a><a id="7242" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#7242" class="Bound">M</a> <a id="7244" class="Symbol">:</a> <a id="7246" href="Cubical.Algebra.Matrix.CommRingCoefficient.html#999" class="Function">Mat</a> <a id="7250" class="Symbol">(</a><a id="7251" class="InductiveConstructor">suc</a> <a id="7255" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#1700" class="Generalizable">m</a><a id="7256" class="Symbol">)</a> <a id="7258" class="Symbol">(</a><a id="7259" class="InductiveConstructor">suc</a> <a id="7263" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#1702" class="Generalizable">n</a><a id="7264" class="Symbol">))</a> <a id="7267" class="Symbol">→</a> <a id="7269" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#4892" class="Record">DiagStep</a> <a id="7278" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#7242" class="Bound">M</a> <a id="7280" href="Cubical.Data.Sum.Base.html#203" class="Datatype Operator">⊎</a> <a id="7282" class="Symbol">(</a><a id="7283" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#7242" class="Bound">M</a> <a id="7285" href="Agda.Builtin.Cubical.Path.html#381" class="Function Operator">≡</a> <a id="7287" href="Cubical.Algebra.Matrix.CommRingCoefficient.html#1482" class="Function">𝟘</a><a id="7288" class="Symbol">)</a>
<a id="7290" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#7230" class="Function">diagStep</a> <a id="7299" class="Symbol">_</a> <a id="7301" class="Symbol">=</a> <a id="7303" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#6853" class="Function">diagStep-getStart</a> <a id="7321" class="Symbol">_</a> <a id="7323" class="Symbol">(</a><a id="7324" href="Cubical.Algebra.IntegerMatrix.Base.html#3035" class="Function">findNonZero</a> <a id="7336" class="Symbol">_)</a>


<a id="7341" class="Comment">-- The diagonalization</a>

<a id="7365" class="Keyword">record</a> <a id="Diag"></a><a id="7372" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#7372" class="Record">Diag</a> <a id="7377" class="Symbol">(</a><a id="7378" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#7378" class="Bound">M</a> <a id="7380" class="Symbol">:</a> <a id="7382" href="Cubical.Algebra.Matrix.CommRingCoefficient.html#999" class="Function">Mat</a> <a id="7386" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#1700" class="Generalizable">m</a> <a id="7388" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#1702" class="Generalizable">n</a><a id="7389" class="Symbol">)</a> <a id="7391" class="Symbol">:</a> <a id="7393" href="Agda.Primitive.html#326" class="Primitive">Type</a> <a id="7398" class="Keyword">where</a>
  <a id="7406" class="Keyword">field</a>
    <a id="Diag.sim"></a><a id="7416" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#7416" class="Field">sim</a> <a id="7420" class="Symbol">:</a> <a id="7422" href="Cubical.Algebra.Matrix.CommRingCoefficient.html#6605" class="Record">Sim</a> <a id="7426" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#7378" class="Bound">M</a>
    <a id="Diag.isdiag"></a><a id="7432" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#7432" class="Field">isdiag</a> <a id="7439" class="Symbol">:</a> <a id="7441" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#2893" class="Record">isDiagonal</a> <a id="7452" class="Symbol">(</a><a id="7453" class="Field">sim</a> <a id="7457" class="Symbol">.</a><a id="7458" href="Cubical.Algebra.Matrix.CommRingCoefficient.html#6654" class="Field">result</a><a id="7464" class="Symbol">)</a>

<a id="7467" class="Keyword">open</a> <a id="7472" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#7372" class="Module">Diag</a>

<a id="simDiag"></a><a id="7478" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#7478" class="Function">simDiag</a> <a id="7486" class="Symbol">:</a> <a id="7488" class="Symbol">{</a><a id="7489" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#7489" class="Bound">M</a> <a id="7491" class="Symbol">:</a> <a id="7493" href="Cubical.Algebra.Matrix.CommRingCoefficient.html#999" class="Function">Mat</a> <a id="7497" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#1700" class="Generalizable">m</a> <a id="7499" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#1702" class="Generalizable">n</a><a id="7500" class="Symbol">}(</a><a id="7502" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#7502" class="Bound">sim</a> <a id="7506" class="Symbol">:</a> <a id="7508" href="Cubical.Algebra.Matrix.CommRingCoefficient.html#6605" class="Record">Sim</a> <a id="7512" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#7489" class="Bound">M</a><a id="7513" class="Symbol">)</a> <a id="7515" class="Symbol">→</a> <a id="7517" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#7372" class="Record">Diag</a> <a id="7522" class="Symbol">(</a><a id="7523" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#7502" class="Bound">sim</a> <a id="7527" class="Symbol">.</a><a id="7528" href="Cubical.Algebra.Matrix.CommRingCoefficient.html#6654" class="Field">result</a><a id="7534" class="Symbol">)</a> <a id="7536" class="Symbol">→</a> <a id="7538" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#7372" class="Record">Diag</a> <a id="7543" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#7489" class="Bound">M</a>
<a id="7545" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#7478" class="Function">simDiag</a> <a id="7553" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#7553" class="Bound">simM</a> <a id="7558" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#7558" class="Bound">diag</a> <a id="7563" class="Symbol">.</a><a id="7564" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#7416" class="Field">sim</a> <a id="7568" class="Symbol">=</a> <a id="7570" href="Cubical.Algebra.Matrix.CommRingCoefficient.html#8222" class="Function">compSim</a> <a id="7578" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#7553" class="Bound">simM</a> <a id="7583" class="Symbol">(</a><a id="7584" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#7558" class="Bound">diag</a> <a id="7589" class="Symbol">.</a><a id="7590" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#7416" class="Field">sim</a><a id="7593" class="Symbol">)</a>
<a id="7595" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#7478" class="Function">simDiag</a> <a id="7603" class="Symbol">_</a> <a id="7605" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#7605" class="Bound">diag</a> <a id="7610" class="Symbol">.</a><a id="7611" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#7432" class="Field">isdiag</a> <a id="7618" class="Symbol">=</a> <a id="7620" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#7605" class="Bound">diag</a> <a id="7625" class="Symbol">.</a><a id="7626" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#7432" class="Field">isdiag</a>

<a id="diag𝟘"></a><a id="7634" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#7634" class="Function">diag𝟘</a> <a id="7640" class="Symbol">:</a> <a id="7642" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#7372" class="Record">Diag</a> <a id="7647" class="Symbol">(</a><a id="7648" href="Cubical.Algebra.Matrix.CommRingCoefficient.html#1482" class="Function">𝟘</a> <a id="7650" class="Symbol">{</a><a id="7651" class="Argument">m</a> <a id="7653" class="Symbol">=</a> <a id="7655" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#1700" class="Generalizable">m</a><a id="7656" class="Symbol">}</a> <a id="7658" class="Symbol">{</a><a id="7659" class="Argument">n</a> <a id="7661" class="Symbol">=</a> <a id="7663" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#1702" class="Generalizable">n</a><a id="7664" class="Symbol">})</a>
<a id="7667" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#7634" class="Function">diag𝟘</a> <a id="7673" class="Symbol">.</a><a id="7674" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#7416" class="Field">sim</a>    <a id="7681" class="Symbol">=</a> <a id="7683" href="Cubical.Algebra.Matrix.CommRingCoefficient.html#6948" class="Function">idSim</a> <a id="7689" class="Symbol">_</a>
<a id="7691" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#7634" class="Function">diag𝟘</a> <a id="7697" class="Symbol">.</a><a id="7698" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#7432" class="Field">isdiag</a> <a id="7705" class="Symbol">=</a> <a id="7707" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#3321" class="Function">isDiagonal𝟘</a>

<a id="diagEmpty"></a><a id="7720" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#7720" class="Function">diagEmpty</a> <a id="7730" class="Symbol">:</a> <a id="7732" class="Symbol">(</a><a id="7733" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#7733" class="Bound">M</a> <a id="7735" class="Symbol">:</a> <a id="7737" href="Cubical.Algebra.Matrix.CommRingCoefficient.html#999" class="Function">Mat</a> <a id="7741" class="Number">0</a> <a id="7743" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#1702" class="Generalizable">n</a><a id="7744" class="Symbol">)</a> <a id="7746" class="Symbol">→</a> <a id="7748" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#7372" class="Record">Diag</a> <a id="7753" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#7733" class="Bound">M</a>
<a id="7755" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#7720" class="Function">diagEmpty</a> <a id="7765" class="Symbol">_</a> <a id="7767" class="Symbol">.</a><a id="7768" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#7416" class="Field">sim</a>    <a id="7775" class="Symbol">=</a> <a id="7777" href="Cubical.Algebra.Matrix.CommRingCoefficient.html#6948" class="Function">idSim</a> <a id="7783" class="Symbol">_</a>
<a id="7785" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#7720" class="Function">diagEmpty</a> <a id="7795" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#7795" class="Bound">M</a> <a id="7797" class="Symbol">.</a><a id="7798" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#7432" class="Field">isdiag</a> <a id="7805" class="Symbol">=</a> <a id="7807" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#3539" class="Function">isDiagonalEmpty</a> <a id="7823" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#7795" class="Bound">M</a>

<a id="diagEmptyᵗ"></a><a id="7826" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#7826" class="Function">diagEmptyᵗ</a> <a id="7837" class="Symbol">:</a> <a id="7839" class="Symbol">(</a><a id="7840" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#7840" class="Bound">M</a> <a id="7842" class="Symbol">:</a> <a id="7844" href="Cubical.Algebra.Matrix.CommRingCoefficient.html#999" class="Function">Mat</a> <a id="7848" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#1700" class="Generalizable">m</a> <a id="7850" class="Number">0</a><a id="7851" class="Symbol">)</a> <a id="7853" class="Symbol">→</a> <a id="7855" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#7372" class="Record">Diag</a> <a id="7860" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#7840" class="Bound">M</a>
<a id="7862" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#7826" class="Function">diagEmptyᵗ</a> <a id="7873" class="Symbol">_</a> <a id="7875" class="Symbol">.</a><a id="7876" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#7416" class="Field">sim</a>    <a id="7883" class="Symbol">=</a> <a id="7885" href="Cubical.Algebra.Matrix.CommRingCoefficient.html#6948" class="Function">idSim</a> <a id="7891" class="Symbol">_</a>
<a id="7893" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#7826" class="Function">diagEmptyᵗ</a> <a id="7904" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#7904" class="Bound">M</a> <a id="7906" class="Symbol">.</a><a id="7907" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#7432" class="Field">isdiag</a> <a id="7914" class="Symbol">=</a> <a id="7916" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#3814" class="Function">isDiagonalEmptyᵗ</a> <a id="7933" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#7904" class="Bound">M</a>

<a id="decompDiagStep"></a><a id="7936" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#7936" class="Function">decompDiagStep</a> <a id="7951" class="Symbol">:</a>
    <a id="7957" class="Symbol">(</a><a id="7958" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#7958" class="Bound">M</a> <a id="7960" class="Symbol">:</a> <a id="7962" href="Cubical.Algebra.Matrix.CommRingCoefficient.html#999" class="Function">Mat</a> <a id="7966" class="Symbol">(</a><a id="7967" class="InductiveConstructor">suc</a> <a id="7971" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#1700" class="Generalizable">m</a><a id="7972" class="Symbol">)</a> <a id="7974" class="Symbol">(</a><a id="7975" class="InductiveConstructor">suc</a> <a id="7979" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#1702" class="Generalizable">n</a><a id="7980" class="Symbol">))(</a><a id="7983" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#7983" class="Bound">step</a> <a id="7988" class="Symbol">:</a> <a id="7990" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#4892" class="Record">DiagStep</a> <a id="7999" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#7958" class="Bound">M</a><a id="8000" class="Symbol">)</a>
  <a id="8004" class="Symbol">→</a> <a id="8006" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#7983" class="Bound">step</a> <a id="8011" class="Symbol">.</a><a id="8012" class="Field">sim</a> <a id="8016" class="Symbol">.</a><a id="8017" href="Cubical.Algebra.Matrix.CommRingCoefficient.html#6654" class="Field">result</a> <a id="8024" href="Agda.Builtin.Cubical.Path.html#381" class="Function Operator">≡</a> <a id="8026" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#7983" class="Bound">step</a> <a id="8031" class="Symbol">.</a><a id="8032" class="Field">sim</a> <a id="8036" class="Symbol">.</a><a id="8037" href="Cubical.Algebra.Matrix.CommRingCoefficient.html#6654" class="Field">result</a> <a id="8044" class="InductiveConstructor">zero</a> <a id="8049" class="InductiveConstructor">zero</a> <a id="8054" href="Cubical.Algebra.Matrix.CommRingCoefficient.html#8427" class="Function Operator">⊕</a> <a id="8056" href="Cubical.Algebra.Matrix.CommRingCoefficient.html#8612" class="Function">sucMat</a> <a id="8063" class="Symbol">(</a><a id="8064" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#7983" class="Bound">step</a> <a id="8069" class="Symbol">.</a><a id="8070" class="Field">sim</a> <a id="8074" class="Symbol">.</a><a id="8075" href="Cubical.Algebra.Matrix.CommRingCoefficient.html#6654" class="Field">result</a><a id="8081" class="Symbol">)</a>
<a id="8083" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#7936" class="Function">decompDiagStep</a> <a id="8098" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#8098" class="Bound">M</a> <a id="8100" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#8100" class="Bound">step</a> <a id="8105" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#8105" class="Bound">t</a> <a id="8107" href="Cubical.Data.FinData.Base.html#399" class="InductiveConstructor">zero</a> <a id="8112" href="Cubical.Data.FinData.Base.html#399" class="InductiveConstructor">zero</a> <a id="8117" class="Symbol">=</a> <a id="8119" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#8100" class="Bound">step</a> <a id="8124" class="Symbol">.</a><a id="8125" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#4952" class="Field">sim</a> <a id="8129" class="Symbol">.</a><a id="8130" href="Cubical.Algebra.Matrix.CommRingCoefficient.html#6654" class="Field">result</a> <a id="8137" href="Cubical.Data.FinData.Base.html#399" class="InductiveConstructor">zero</a> <a id="8142" href="Cubical.Data.FinData.Base.html#399" class="InductiveConstructor">zero</a>
<a id="8147" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#7936" class="Function">decompDiagStep</a> <a id="8162" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#8162" class="Bound">M</a> <a id="8164" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#8164" class="Bound">step</a> <a id="8169" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#8169" class="Bound">t</a> <a id="8171" href="Cubical.Data.FinData.Base.html#399" class="InductiveConstructor">zero</a> <a id="8176" class="Symbol">(</a><a id="8177" href="Cubical.Data.FinData.Base.html#430" class="InductiveConstructor">suc</a> <a id="8181" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#8181" class="Bound">j</a><a id="8182" class="Symbol">)</a> <a id="8184" class="Symbol">=</a> <a id="8186" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#8164" class="Bound">step</a> <a id="8191" class="Symbol">.</a><a id="8192" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#5032" class="Field">firstRowClean</a> <a id="8206" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#8181" class="Bound">j</a> <a id="8208" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#8169" class="Bound">t</a>
<a id="8210" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#7936" class="Function">decompDiagStep</a> <a id="8225" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#8225" class="Bound">M</a> <a id="8227" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#8227" class="Bound">step</a> <a id="8232" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#8232" class="Bound">t</a> <a id="8234" class="Symbol">(</a><a id="8235" href="Cubical.Data.FinData.Base.html#430" class="InductiveConstructor">suc</a> <a id="8239" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#8239" class="Bound">i</a><a id="8240" class="Symbol">)</a> <a id="8242" href="Cubical.Data.FinData.Base.html#399" class="InductiveConstructor">zero</a> <a id="8247" class="Symbol">=</a> <a id="8249" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#8227" class="Bound">step</a> <a id="8254" class="Symbol">.</a><a id="8255" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#4969" class="Field">firstColClean</a> <a id="8269" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#8239" class="Bound">i</a> <a id="8271" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#8232" class="Bound">t</a>
<a id="8273" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#7936" class="Function">decompDiagStep</a> <a id="8288" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#8288" class="Bound">M</a> <a id="8290" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#8290" class="Bound">step</a> <a id="8295" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#8295" class="Bound">t</a> <a id="8297" class="Symbol">(</a><a id="8298" href="Cubical.Data.FinData.Base.html#430" class="InductiveConstructor">suc</a> <a id="8302" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#8302" class="Bound">i</a><a id="8303" class="Symbol">)</a> <a id="8305" class="Symbol">(</a><a id="8306" href="Cubical.Data.FinData.Base.html#430" class="InductiveConstructor">suc</a> <a id="8310" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#8310" class="Bound">j</a><a id="8311" class="Symbol">)</a> <a id="8313" class="Symbol">=</a> <a id="8315" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#8290" class="Bound">step</a> <a id="8320" class="Symbol">.</a><a id="8321" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#4952" class="Field">sim</a> <a id="8325" class="Symbol">.</a><a id="8326" href="Cubical.Algebra.Matrix.CommRingCoefficient.html#6654" class="Field">result</a> <a id="8333" class="Symbol">(</a><a id="8334" href="Cubical.Data.FinData.Base.html#430" class="InductiveConstructor">suc</a> <a id="8338" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#8302" class="Bound">i</a><a id="8339" class="Symbol">)</a> <a id="8341" class="Symbol">(</a><a id="8342" href="Cubical.Data.FinData.Base.html#430" class="InductiveConstructor">suc</a> <a id="8346" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#8310" class="Bound">j</a><a id="8347" class="Symbol">)</a>

<a id="consIsDiagonal"></a><a id="8350" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#8350" class="Function">consIsDiagonal</a> <a id="8365" class="Symbol">:</a>
    <a id="8371" class="Symbol">(</a><a id="8372" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#8372" class="Bound">a</a> <a id="8374" class="Symbol">:</a> <a id="8376" href="Cubical.Data.Int.Base.html#393" class="Datatype">ℤ</a><a id="8377" class="Symbol">)(</a><a id="8379" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#8379" class="Bound">M</a> <a id="8381" class="Symbol">:</a> <a id="8383" href="Cubical.Algebra.Matrix.CommRingCoefficient.html#999" class="Function">Mat</a> <a id="8387" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#1700" class="Generalizable">m</a> <a id="8389" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#1702" class="Generalizable">n</a><a id="8390" class="Symbol">)</a>
  <a id="8394" class="Symbol">→</a> <a id="8396" class="Symbol">(</a><a id="8397" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#8397" class="Bound">p</a> <a id="8399" class="Symbol">:</a> <a id="8401" href="Cubical.Relation.Nullary.Base.html#355" class="Function Operator">¬</a> <a id="8403" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#8372" class="Bound">a</a> <a id="8405" href="Agda.Builtin.Cubical.Path.html#381" class="Function Operator">≡</a> <a id="8407" class="Number">0</a><a id="8408" class="Symbol">)</a>
  <a id="8412" class="Symbol">→</a> <a id="8414" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#2893" class="Record">isDiagonal</a> <a id="8425" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#8379" class="Bound">M</a> <a id="8427" class="Symbol">→</a> <a id="8429" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#2893" class="Record">isDiagonal</a> <a id="8440" class="Symbol">(</a><a id="8441" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#8372" class="Bound">a</a> <a id="8443" href="Cubical.Algebra.Matrix.CommRingCoefficient.html#8427" class="Function Operator">⊕</a> <a id="8445" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#8379" class="Bound">M</a><a id="8446" class="Symbol">)</a>
<a id="8448" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#8350" class="Function">consIsDiagonal</a> <a id="8463" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#8463" class="Bound">a</a> <a id="8465" class="Symbol">_</a> <a id="8467" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#8467" class="Bound">p</a> <a id="8469" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#8469" class="Bound">diag</a> <a id="8474" class="Symbol">.</a><a id="8475" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#2943" class="Field">divs</a> <a id="8480" class="Symbol">=</a> <a id="8482" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#2249" class="Function">cons</a> <a id="8487" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#8463" class="Bound">a</a> <a id="8489" class="Symbol">(</a><a id="8490" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#8469" class="Bound">diag</a> <a id="8495" class="Symbol">.</a><a id="8496" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#2943" class="Field">divs</a><a id="8500" class="Symbol">)</a> <a id="8502" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#8467" class="Bound">p</a>
<a id="8504" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#8350" class="Function">consIsDiagonal</a> <a id="8519" class="Symbol">_</a> <a id="8521" class="Symbol">_</a> <a id="8523" class="Symbol">_</a> <a id="8525" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#8525" class="Bound">diag</a> <a id="8530" class="Symbol">.</a><a id="8531" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#2966" class="Field">rowNull</a> <a id="8539" class="Symbol">=</a> <a id="8541" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#8525" class="Bound">diag</a> <a id="8546" class="Symbol">.</a><a id="8547" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#2966" class="Field">rowNull</a>
<a id="8555" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#8350" class="Function">consIsDiagonal</a> <a id="8570" class="Symbol">_</a> <a id="8572" class="Symbol">_</a> <a id="8574" class="Symbol">_</a> <a id="8576" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#8576" class="Bound">diag</a> <a id="8581" class="Symbol">.</a><a id="8582" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#2982" class="Field">colNull</a> <a id="8590" class="Symbol">=</a> <a id="8592" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#8576" class="Bound">diag</a> <a id="8597" class="Symbol">.</a><a id="8598" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#2982" class="Field">colNull</a>
<a id="8606" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#8350" class="Function">consIsDiagonal</a> <a id="8621" class="Symbol">_</a> <a id="8623" class="Symbol">_</a> <a id="8625" class="Symbol">_</a> <a id="8627" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#8627" class="Bound">diag</a> <a id="8632" class="Symbol">.</a><a id="8633" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#2999" class="Field">rowEq</a> <a id="8639" class="Symbol">=</a> <a id="8641" class="Symbol">(λ</a> <a id="8644" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#8644" class="Bound">t</a> <a id="8646" class="Symbol">→</a> <a id="8648" href="Agda.Builtin.Nat.html#223" class="InductiveConstructor">suc</a> <a id="8652" class="Symbol">(</a><a id="8653" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#8627" class="Bound">diag</a> <a id="8658" class="Symbol">.</a><a id="8659" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#2999" class="Field">rowEq</a> <a id="8665" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#8644" class="Bound">t</a><a id="8666" class="Symbol">))</a>
<a id="8669" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#8350" class="Function">consIsDiagonal</a> <a id="8684" class="Symbol">_</a> <a id="8686" class="Symbol">_</a> <a id="8688" class="Symbol">_</a> <a id="8690" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#8690" class="Bound">diag</a> <a id="8695" class="Symbol">.</a><a id="8696" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#3036" class="Field">colEq</a> <a id="8702" class="Symbol">=</a> <a id="8704" class="Symbol">(λ</a> <a id="8707" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#8707" class="Bound">t</a> <a id="8709" class="Symbol">→</a> <a id="8711" href="Agda.Builtin.Nat.html#223" class="InductiveConstructor">suc</a> <a id="8715" class="Symbol">(</a><a id="8716" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#8690" class="Bound">diag</a> <a id="8721" class="Symbol">.</a><a id="8722" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#3036" class="Field">colEq</a> <a id="8728" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#8707" class="Bound">t</a><a id="8729" class="Symbol">))</a>
<a id="8732" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#8350" class="Function">consIsDiagonal</a> <a id="8747" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#8747" class="Bound">a</a> <a id="8749" class="Symbol">_</a> <a id="8751" class="Symbol">_</a> <a id="8753" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#8753" class="Bound">diag</a> <a id="8758" class="Symbol">.</a><a id="8759" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#3073" class="Field">matEq</a> <a id="8765" class="Symbol">=</a> <a id="8767" class="Symbol">(λ</a> <a id="8770" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#8770" class="Bound">t</a> <a id="8772" class="Symbol">→</a> <a id="8774" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#8747" class="Bound">a</a> <a id="8776" href="Cubical.Algebra.Matrix.CommRingCoefficient.html#8427" class="Function Operator">⊕</a> <a id="8778" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#8753" class="Bound">diag</a> <a id="8783" class="Symbol">.</a><a id="8784" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#3073" class="Field">matEq</a> <a id="8790" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#8770" class="Bound">t</a><a id="8791" class="Symbol">)</a>

<a id="diagReduction"></a><a id="8794" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#8794" class="Function">diagReduction</a> <a id="8808" class="Symbol">:</a>
    <a id="8814" class="Symbol">(</a><a id="8815" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#8815" class="Bound">a</a> <a id="8817" class="Symbol">:</a> <a id="8819" href="Cubical.Data.Int.Base.html#393" class="Datatype">ℤ</a><a id="8820" class="Symbol">)(</a><a id="8822" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#8822" class="Bound">M</a> <a id="8824" class="Symbol">:</a> <a id="8826" href="Cubical.Algebra.Matrix.CommRingCoefficient.html#999" class="Function">Mat</a> <a id="8830" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#1700" class="Generalizable">m</a> <a id="8832" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#1702" class="Generalizable">n</a><a id="8833" class="Symbol">)</a>
  <a id="8837" class="Symbol">→</a> <a id="8839" class="Symbol">(</a><a id="8840" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#8840" class="Bound">p</a> <a id="8842" class="Symbol">:</a> <a id="8844" href="Cubical.Relation.Nullary.Base.html#355" class="Function Operator">¬</a> <a id="8846" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#8815" class="Bound">a</a> <a id="8848" href="Agda.Builtin.Cubical.Path.html#381" class="Function Operator">≡</a> <a id="8850" class="Number">0</a><a id="8851" class="Symbol">)</a>
  <a id="8855" class="Symbol">→</a> <a id="8857" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#7372" class="Record">Diag</a> <a id="8862" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#8822" class="Bound">M</a> <a id="8864" class="Symbol">→</a> <a id="8866" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#7372" class="Record">Diag</a> <a id="8871" class="Symbol">(</a><a id="8872" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#8815" class="Bound">a</a> <a id="8874" href="Cubical.Algebra.Matrix.CommRingCoefficient.html#8427" class="Function Operator">⊕</a> <a id="8876" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#8822" class="Bound">M</a><a id="8877" class="Symbol">)</a>
<a id="8879" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#8794" class="Function">diagReduction</a> <a id="8893" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#8893" class="Bound">a</a> <a id="8895" class="Symbol">_</a> <a id="8897" class="Symbol">_</a> <a id="8899" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#8899" class="Bound">diag</a> <a id="8904" class="Symbol">.</a><a id="8905" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#7416" class="Field">sim</a> <a id="8909" class="Symbol">=</a> <a id="8911" href="Cubical.Algebra.Matrix.CommRingCoefficient.html#10539" class="Function">⊕Sim</a> <a id="8916" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#8893" class="Bound">a</a> <a id="8918" class="Symbol">(</a><a id="8919" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#8899" class="Bound">diag</a> <a id="8924" class="Symbol">.</a><a id="8925" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#7416" class="Field">sim</a><a id="8928" class="Symbol">)</a>
<a id="8930" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#8794" class="Function">diagReduction</a> <a id="8944" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#8944" class="Bound">a</a> <a id="8946" class="Symbol">_</a> <a id="8948" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#8948" class="Bound">p</a> <a id="8950" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#8950" class="Bound">diag</a> <a id="8955" class="Symbol">.</a><a id="8956" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#7432" class="Field">isdiag</a> <a id="8963" class="Symbol">=</a> <a id="8965" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#8350" class="Function">consIsDiagonal</a> <a id="8980" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#8944" class="Bound">a</a> <a id="8982" class="Symbol">_</a> <a id="8984" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#8948" class="Bound">p</a> <a id="8986" class="Symbol">(</a><a id="8987" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#8950" class="Bound">diag</a> <a id="8992" class="Symbol">.</a><a id="8993" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#7432" class="Field">isdiag</a><a id="8999" class="Symbol">)</a>


<a id="9003" class="Comment">-- The Existence of Diagonalization</a>

<a id="diagonalize"></a><a id="9040" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#9040" class="Function">diagonalize</a> <a id="9052" class="Symbol">:</a> <a id="9054" class="Symbol">(</a><a id="9055" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#9055" class="Bound">M</a> <a id="9057" class="Symbol">:</a> <a id="9059" href="Cubical.Algebra.Matrix.CommRingCoefficient.html#999" class="Function">Mat</a> <a id="9063" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#1700" class="Generalizable">m</a> <a id="9065" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#1702" class="Generalizable">n</a><a id="9066" class="Symbol">)</a> <a id="9068" class="Symbol">→</a> <a id="9070" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#7372" class="Record">Diag</a> <a id="9075" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#9055" class="Bound">M</a>
<a id="9077" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#9040" class="Function">diagonalize</a> <a id="9089" class="Symbol">{</a><a id="9090" class="Argument">m</a> <a id="9092" class="Symbol">=</a> <a id="9094" class="Number">0</a><a id="9095" class="Symbol">}</a> <a id="9097" class="Symbol">=</a> <a id="9099" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#7720" class="Function">diagEmpty</a>
<a id="9109" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#9040" class="Function">diagonalize</a> <a id="9121" class="Symbol">{</a><a id="9122" class="Argument">m</a> <a id="9124" class="Symbol">=</a> <a id="9126" href="Agda.Builtin.Nat.html#223" class="InductiveConstructor">suc</a> <a id="9130" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#9130" class="Bound">m</a><a id="9131" class="Symbol">}</a> <a id="9133" class="Symbol">{</a><a id="9134" class="Argument">n</a> <a id="9136" class="Symbol">=</a> <a id="9138" class="Number">0</a><a id="9139" class="Symbol">}</a> <a id="9141" class="Symbol">=</a> <a id="9143" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#7826" class="Function">diagEmptyᵗ</a>
<a id="9154" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#9040" class="Function">diagonalize</a> <a id="9166" class="Symbol">{</a><a id="9167" class="Argument">m</a> <a id="9169" class="Symbol">=</a> <a id="9171" href="Agda.Builtin.Nat.html#223" class="InductiveConstructor">suc</a> <a id="9175" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#9175" class="Bound">m</a><a id="9176" class="Symbol">}</a> <a id="9178" class="Symbol">{</a><a id="9179" class="Argument">n</a> <a id="9181" class="Symbol">=</a> <a id="9183" href="Agda.Builtin.Nat.html#223" class="InductiveConstructor">suc</a> <a id="9187" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#9187" class="Bound">n</a><a id="9188" class="Symbol">}</a> <a id="9190" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#9190" class="Bound">M</a> <a id="9192" class="Symbol">=</a> <a id="9194" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#9224" class="Function">helper</a> <a id="9201" class="Symbol">(</a><a id="9202" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#7230" class="Function">diagStep</a> <a id="9211" class="Symbol">_)</a>
  <a id="9216" class="Keyword">where</a>
  <a id="9224" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#9224" class="Function">helper</a> <a id="9231" class="Symbol">:</a> <a id="9233" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#4892" class="Record">DiagStep</a> <a id="9242" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#9190" class="Bound">M</a> <a id="9244" href="Cubical.Data.Sum.Base.html#203" class="Datatype Operator">⊎</a> <a id="9246" class="Symbol">(</a><a id="9247" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#9190" class="Bound">M</a> <a id="9249" href="Agda.Builtin.Cubical.Path.html#381" class="Function Operator">≡</a> <a id="9251" href="Cubical.Algebra.Matrix.CommRingCoefficient.html#1482" class="Function">𝟘</a><a id="9252" class="Symbol">)</a> <a id="9254" class="Symbol">→</a> <a id="9256" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#7372" class="Record">Diag</a> <a id="9261" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#9190" class="Bound">M</a>
  <a id="9265" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#9224" class="Function">helper</a> <a id="9272" class="Symbol">(</a><a id="9273" href="Cubical.Data.Sum.Base.html#279" class="InductiveConstructor">inr</a> <a id="9277" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#9277" class="Bound">p</a><a id="9278" class="Symbol">)</a> <a id="9280" class="Symbol">=</a> <a id="9282" href="Cubical.Foundations.Prelude.html#8526" class="Function">subst</a> <a id="9288" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#7372" class="Record">Diag</a> <a id="9293" class="Symbol">(</a><a id="9294" href="Cubical.Foundations.Prelude.html#942" class="Function">sym</a> <a id="9298" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#9277" class="Bound">p</a><a id="9299" class="Symbol">)</a> <a id="9301" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#7634" class="Function">diag𝟘</a>
  <a id="9309" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#9224" class="Function">helper</a> <a id="9316" class="Symbol">(</a><a id="9317" href="Cubical.Data.Sum.Base.html#261" class="InductiveConstructor">inl</a> <a id="9321" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#9321" class="Bound">stepM</a><a id="9326" class="Symbol">)</a> <a id="9328" class="Symbol">=</a>
    <a id="9334" class="Keyword">let</a> <a id="9338" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#9338" class="Bound">sucM</a> <a id="9343" class="Symbol">=</a> <a id="9345" href="Cubical.Algebra.Matrix.CommRingCoefficient.html#8612" class="Function">sucMat</a> <a id="9352" class="Symbol">(</a><a id="9353" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#9321" class="Bound">stepM</a> <a id="9359" class="Symbol">.</a><a id="9360" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#4952" class="Field">sim</a> <a id="9364" class="Symbol">.</a><a id="9365" href="Cubical.Algebra.Matrix.CommRingCoefficient.html#6654" class="Field">result</a><a id="9371" class="Symbol">)</a>
        <a id="9381" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#9381" class="Bound">diagM</a> <a id="9387" class="Symbol">=</a> <a id="9389" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#8794" class="Function">diagReduction</a> <a id="9403" class="Symbol">_</a> <a id="9405" class="Symbol">_</a> <a id="9407" class="Symbol">(</a><a id="9408" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#9321" class="Bound">stepM</a> <a id="9414" class="Symbol">.</a><a id="9415" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#5096" class="Field">nonZero</a><a id="9422" class="Symbol">)</a> <a id="9424" class="Symbol">(</a><a id="9425" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#9040" class="Function">diagonalize</a> <a id="9437" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#9338" class="Bound">sucM</a><a id="9441" class="Symbol">)</a>
    <a id="9447" class="Keyword">in</a>  <a id="9451" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#7478" class="Function">simDiag</a> <a id="9459" class="Symbol">(</a><a id="9460" href="Cubical.Algebra.Matrix.CommRingCoefficient.html#8222" class="Function">compSim</a> <a id="9468" class="Symbol">(</a><a id="9469" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#9321" class="Bound">stepM</a> <a id="9475" class="Symbol">.</a><a id="9476" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#4952" class="Field">sim</a><a id="9479" class="Symbol">)</a> <a id="9481" class="Symbol">(</a><a id="9482" href="Cubical.Algebra.Matrix.CommRingCoefficient.html#7285" class="Function">≡Sim</a> <a id="9487" class="Symbol">(</a><a id="9488" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#7936" class="Function">decompDiagStep</a> <a id="9503" class="Symbol">_</a> <a id="9505" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#9321" class="Bound">stepM</a><a id="9510" class="Symbol">)))</a> <a id="9514" href="Cubical.Algebra.IntegerMatrix.Diagonalization.html#9381" class="Bound">diagM</a>
</pre></body></html>